<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>User History and Recommendations - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/latest.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","maxCustomTags":45,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"spark_heap_memory":21145,"instance_type_id":"r3.xlarge","node_type_id":"r3.xlarge","description":"r3.xlarge (beta)","support_cluster_tags":true,"container_memory_mb":26432,"memory_mb":31232,"category":"Memory Optimized","num_cores":4.0,"support_ebs_volumes":true},{"spark_heap_memory":46131,"instance_type_id":"r3.2xlarge","node_type_id":"r3.2xlarge","description":"r3.2xlarge (beta)","support_cluster_tags":true,"container_memory_mb":57664,"memory_mb":62464,"category":"Memory Optimized","num_cores":8.0,"support_ebs_volumes":true},{"spark_heap_memory":96102,"instance_type_id":"r3.4xlarge","node_type_id":"r3.4xlarge","description":"r3.4xlarge (beta)","support_cluster_tags":true,"container_memory_mb":120128,"memory_mb":124928,"category":"Memory Optimized","num_cores":16.0,"support_ebs_volumes":true},{"spark_heap_memory":196044,"instance_type_id":"r3.8xlarge","node_type_id":"r3.8xlarge","description":"r3.8xlarge (beta)","support_cluster_tags":true,"container_memory_mb":245056,"memory_mb":249856,"category":"Memory Optimized","num_cores":32.0,"support_ebs_volumes":true},{"spark_heap_memory":8448,"instance_type_id":"c3.2xlarge","node_type_id":"c3.2xlarge","description":"c3.2xlarge (beta)","support_cluster_tags":true,"container_memory_mb":10560,"memory_mb":15360,"category":"Compute Optimized","num_cores":8.0,"support_ebs_volumes":true},{"spark_heap_memory":20736,"instance_type_id":"c3.4xlarge","node_type_id":"c3.4xlarge","description":"c3.4xlarge (beta)","support_cluster_tags":true,"container_memory_mb":25920,"memory_mb":30720,"category":"Compute Optimized","num_cores":16.0,"support_ebs_volumes":true},{"spark_heap_memory":45312,"instance_type_id":"c3.8xlarge","node_type_id":"c3.8xlarge","description":"c3.8xlarge (beta)","support_cluster_tags":true,"container_memory_mb":56640,"memory_mb":61440,"category":"Compute Optimized","num_cores":32.0,"support_ebs_volumes":true},{"spark_heap_memory":21145,"instance_type_id":"i2.xlarge","node_type_id":"i2.xlarge","description":"i2.xlarge (beta)","support_cluster_tags":true,"container_memory_mb":26432,"memory_mb":31232,"category":"Storage Optimized","num_cores":4.0,"support_ebs_volumes":true},{"spark_heap_memory":46131,"instance_type_id":"i2.2xlarge","node_type_id":"i2.2xlarge","description":"i2.2xlarge (beta)","support_cluster_tags":true,"container_memory_mb":57664,"memory_mb":62464,"category":"Storage Optimized","num_cores":8.0,"support_ebs_volumes":true},{"spark_heap_memory":96102,"instance_type_id":"i2.4xlarge","node_type_id":"i2.4xlarge","description":"i2.4xlarge (beta)","support_cluster_tags":true,"container_memory_mb":120128,"memory_mb":124928,"category":"Storage Optimized","num_cores":16.0,"support_ebs_volumes":true},{"spark_heap_memory":196044,"instance_type_id":"i2.8xlarge","node_type_id":"i2.8xlarge","description":"i2.8xlarge (beta)","support_cluster_tags":true,"container_memory_mb":245056,"memory_mb":249856,"category":"Storage Optimized","num_cores":32.0,"support_ebs_volumes":true},{"spark_heap_memory":23800,"instance_type_id":"r3.2xlarge","node_type_id":"memory-optimized","description":"Memory Optimized","support_cluster_tags":false,"container_memory_mb":28000,"memory_mb":30720,"category":"Memory Optimized","num_cores":4.0,"support_ebs_volumes":false},{"spark_heap_memory":9702,"instance_type_id":"c3.4xlarge","node_type_id":"compute-optimized","description":"Compute Optimized","support_cluster_tags":false,"container_memory_mb":12128,"memory_mb":15360,"category":"Compute Optimized","num_cores":8.0,"support_ebs_volumes":false}],"default_node_type_id":"memory-optimized"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":0,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-east-1e","isDefault":true},{"id":"us-east-1b","isDefault":false},{"id":"us-east-1c","isDefault":false},{"id":"us-east-1d","isDefault":false}],"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":false,"enableMaxConcurrentRuns":false,"enableJobAclsConfig":true,"enableFullTextSearch":true,"enableElasticSparkUI":true,"enableNewClustersCreate":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":true,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0 RC5 (Scala 2.11)","packageLabel":"spark-image-20833506f690f3a49c53fb08837cb9b98f7f2e15380f1fb26efc158d953e94c8","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-6c2dd678fff350c03ba0e945bab52d0080cd857a39c99a22131b3e824bb8096f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":true},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-4f22a8d3016bc3dce9e839b10418815a7d28afff3a027b43bd2b041c42b2a89d","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-596490ba3e0ca4b62abb048923fc70de84e319cf527bb7a5a8f609bbf780bed8","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":true},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0 RC5 (Scala 2.10)","packageLabel":"spark-image-f430b652793cbc27e454dc629737ae2bc04b75a1fecd68a5d90c44eca7543756","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":false,"enableFeedback":true,"enableClusterAutoScaling":true,"enableUserVisibleDefaultTags":false,"defaultNumWorkers":8,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":true,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"p2.8xlarge":16,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"memory-optimized":1,"p2.16xlarge":24,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":true,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":false,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.33.220","accountsLimit":-1,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":30,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":true,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"support@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":false,"enableWorkspaceAclsConfig":true,"dropzoneMaxFileSize":4096,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-4f22a8d3016bc3dce9e839b10418815a7d28afff3a027b43bd2b041c42b2a89d","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"useDevTierHomePage":false,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":true,"enableClusterAclsByTier":true,"databricksDocsBaseUrl":"https://docs.databricks.com/","disallowAddingAdmins":false,"enableSparkConfUI":true,"featureTier":"UNKNOWN_TIER","enableOrgSwitcherUI":false,"clustersLimit":-1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":false,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"http://feedback.databricks.com/forums/263785-product-feedback","enableMountAclService":true,"enableWorkspaceAcls":true,"maxClusterTagKeyLength":127,"gitHash":"8719902676c4e1cefbc31755c1726979bdf286d0","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":false,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":true,"enableJobsRetryOnTimeout":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"upgradeURL":"","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":true,"enableTerminal":false,"defaultMemoryPerContainerMB":28000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"enableNewClustersGet":false,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":925,"name":"User History and Recommendations","language":"python","commands":[{"version":"CommandV1","origId":938,"guid":"d2a80322-df1d-4af1-9b1f-bdfe5ef79434","subtype":"command","commandType":"auto","position":0.5,"command":"%md # Create mappings from song_id to spotify_id","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"45dbcf68-6efb-408d-aa6e-745c1b147819"},{"version":"CommandV1","origId":939,"guid":"1c995d01-473f-49d6-be2e-858992e9a258","subtype":"command","commandType":"auto","position":0.75,"command":"# Run this cell to setup data path\nimport os\nfrom pyspark.mllib.recommendation import ALS, MatrixFactorizationModel, Rating\n\n# Configuration\ndatapath = os.getcwd()\nif datapath.find('databricks') != -1:\n  ACCESS_KEY =   \"\"\n  SECRET_KEY = \"+\"\n  ENCODED_SECRET_KEY = SECRET_KEY.replace(\"/\", \"%2F\")\n  AWS_BUCKET_NAME = \"dummyvarsmillionsong\"\n  MOUNT_NAME = \"/S3/\"\n  datapath = \"s3a://%s:%s@%s/\" %(ACCESS_KEY, SECRET_KEY, AWS_BUCKET_NAME)\nelse:\n  print \"Error! Not on databricks server\"\n  \n# Load and parse ratings\ntripletsRDD = sc.textFile('processed_data/ratings_full.txt')\nratings = tripletsRDD.map(lambda l: l.split(','))\\\n    .map(lambda l: Rating(int(l[0]), int(l[1]), float(l[2])))\n  \n# Load spotify user data\nspotify_triplets = sc.textFile(\"/mnt/S3/processed_data/josh_ratings.txt,/mnt/S3/processed_data/oamar_ratings.txt,/mnt/S3/processed_data/james_ratings.txt\")\n\nspotify_ratings = spotify_triplets.map(lambda l: l.split(','))\\\n    .map(lambda l: Rating(int(l[0]), int(l[1]), float(l[2])))\n  \n# HACK: Add Spotify users to see history and recommendations\nratings = ratings.union(spotify_ratings)\nusers = ratings.map(lambda x: x.user).distinct()\n\n# Sanity check\nprint users.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">1019321\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 8 in stage 2.0 failed 4 times, most recent failure: Lost task 8.3 in stage 2.0 (TID 75, 10.172.242.180): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-2-5e91423dbb0f&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     20</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     21</span> <span class=\"ansired\"># Sanity check</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 22</span><span class=\"ansiyellow\"> </span><span class=\"ansigreen\">print</span> users<span class=\"ansiyellow\">.</span>take<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">take</span><span class=\"ansiblue\">(self, num)</span>\n<span class=\"ansigreen\">   1308</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1309</span>             p <span class=\"ansiyellow\">=</span> range<span class=\"ansiyellow\">(</span>partsScanned<span class=\"ansiyellow\">,</span> min<span class=\"ansiyellow\">(</span>partsScanned <span class=\"ansiyellow\">+</span> numPartsToTry<span class=\"ansiyellow\">,</span> totalParts<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1310</span><span class=\"ansiyellow\">             </span>res <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">,</span> takeUpToNumLeft<span class=\"ansiyellow\">,</span> p<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1311</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1312</span>             items <span class=\"ansiyellow\">+=</span> res<span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/context.py</span> in <span class=\"ansicyan\">runJob</span><span class=\"ansiblue\">(self, rdd, partitionFunc, partitions, allowLocal)</span>\n<span class=\"ansigreen\">    931</span>         <span class=\"ansired\"># SparkContext#runJob.</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    932</span>         mappedRDD <span class=\"ansiyellow\">=</span> rdd<span class=\"ansiyellow\">.</span>mapPartitions<span class=\"ansiyellow\">(</span>partitionFunc<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 933</span><span class=\"ansiyellow\">         </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>runJob<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jsc<span class=\"ansiyellow\">.</span>sc<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">,</span> partitions<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    934</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> mappedRDD<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    935</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.3-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.3-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 8 in stage 2.0 failed 4 times, most recent failure: Lost task 8.3 in stage 2.0 (TID 75, 10.172.242.180): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 172, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 167, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2371, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2371, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 317, in func\n    return f(iterator)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1792, in combineLocally\n    merger.mergeValues(iterator)\n  File &quot;/databricks/spark/python/pyspark/shuffle.py&quot;, line 236, in mergeValues\n    for k, v in iterator:\n  File &quot;&lt;ipython-input-2-5e91423dbb0f&gt;&quot;, line 18, in &lt;lambda&gt;\nNameError: global name &apos;Rating&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:283)\n\tat org.apache.spark.api.python.PairwiseRDD.compute(PythonRDD.scala:390)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:283)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:79)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:47)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:86)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:274)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1454)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1441)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1441)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:811)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:811)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:811)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1667)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1622)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1611)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:632)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1891)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1904)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1917)\n\tat org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:441)\n\tat org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:237)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 172, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 167, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2371, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 2371, in pipeline_func\n    return func(split, prev_func(split, iterator))\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 317, in func\n    return f(iterator)\n  File &quot;/databricks/spark/python/pyspark/rdd.py&quot;, line 1792, in combineLocally\n    merger.mergeValues(iterator)\n  File &quot;/databricks/spark/python/pyspark/shuffle.py&quot;, line 236, in mergeValues\n    for k, v in iterator:\n  File &quot;&lt;ipython-input-2-5e91423dbb0f&gt;&quot;, line 18, in &lt;lambda&gt;\nNameError: global name &apos;Rating&apos; is not defined\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:283)\n\tat org.apache.spark.api.python.PairwiseRDD.compute(PythonRDD.scala:390)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:283)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:79)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:47)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:86)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:274)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n</div>","workflows":[],"startTime":1.482017188666E12,"submitTime":1.482017187012E12,"finishTime":1.482017250318E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"383e3090-0693-4a55-91ef-de6459e4f996"},{"version":"CommandV1","origId":1045,"guid":"c18797ce-a7fe-47c7-a130-c4b42f3b9c37","subtype":"command","commandType":"auto","position":4.0,"command":"%md # Helper Functions","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d48c48bf-07ba-4a82-91ba-5cda097e5186"},{"version":"CommandV1","origId":1035,"guid":"5b327bd5-ec10-44b8-a99c-91b2fda87bf1","subtype":"command","commandType":"auto","position":7.0,"command":"# Load corresponding files\nimport os, json\n\ndef get_song_info(song_json):\n  \"\"\"\n  Return the tuple (song_id, spotify_id, track_name, artist_name) given a json format.\n  song_id is of the form 'SOXXX' as defined by million song dataset.\n  \"\"\"\n  \n  song_dict = json.loads(song_json)\n  try:\n    song = song_dict['response']['songs'][0]\n\n    song_id = song['id']\n    artist_name = song['artist_name']\n    track_name = song['title']\n\n    spotify_id = ''\n    for t in song['tracks']:\n      foreign_id = t['foreign_id']\n      if foreign_id.startswith('spotify'):\n        spotify_id = foreign_id\n  except:\n    print \"No song information available!\"\n    return None\n\n  return (song_id, spotify_id, artist_name, track_name)\n  \ndef get_song_path(song_id):\n  \"\"\"Get a song_id's json file path\"\"\"\n  \n  path_to_mappings = \"/mnt/S3/mapping/\"\n  folder_name = song_id[2:4]\n  return os.path.join(path_to_mappings, folder_name, song_id + '.json')\n\ndef get_song_details(rec_ids):\n  \"\"\"\n  Return song info for each song in rec_ids.\n  rec_ids contains the integers specifying the song index used in the recommendation algorithm.\n  \"\"\"\n  \n  # Map rec_ids to song_ids\n  # Note that we change the order so we can lookup song id from recommended id\n  kaggle_songs_path = os.path.join(datapath, \"raw_data/fromKaggle/kaggle_songs.txt\")\n  song_ids_list = sc.textFile(kaggle_songs_path)\\\n    .map(lambda x: x.split())\\\n    .map(lambda x: (int(x[1]), x[0]))\\\n    .filter(lambda x: x[0] in rec_ids)\\\n    .collect()\n  \n  song_ids_mapping = dict(song_ids_list)\n  \n  song_ids = [song_ids_mapping[id] for id in rec_ids]\n  \n  # Map songs_ids to info\n  path_to_song_files = [get_song_path(song_id) for song_id in song_ids]\n  \n  song_files = sc.textFile(','.join(path_to_song_files))\n  song_details = song_files.map(lambda x: get_song_info(x)).collect()\n  return song_details\n\ndef get_spotify_ids(rec_ids):\n  \"\"\"\n  Return the spotify ids of songs in rec_ids.\n  rec_ids contains the integers specifying the song index used in the recommendation algorithm.\n  \"\"\"\n  song_details = get_song_details(rec_ids)\n  spotify_ids = [d[1] for d in song_details if d]\n  return spotify_ids\n\ndef details_to_string(details):\n  \"\"\"Print the artist and track name of a song\"\"\"\n  \n  return details[2] + ' - ' + details[3] \n\ndef get_history_by_user(user_ids):\n  \"\"\"Output the history of users as (artist - track) pairs\"\"\"\n  \n  user_product_pairs = ratings.filter(lambda x: x[0] in user_ids).map(lambda x: (x[0], x[1])).collect()\n  \n  return get_song_names_by_user(user_product_pairs)\n\ndef get_song_names_by_user(user_product_pairs):\n  \"\"\"Output the song names of users as (artist - track) pairs\"\"\"\n  \n  # Get song ids\n  song_ids = [p[1] for p in user_product_pairs]\n  \n  # Get song details\n  song_details = get_song_details(song_ids)\n\n  # Artist and track names\n  track_names = [details_to_string(d) if d else 'N/A' for d in song_details]\n  \n  user_song_pairs = [(pair[0][0], pair[1])for pair in zip(user_product_pairs, track_names)]\n\n  # Aggregate by user\n  from collections import defaultdict\n  songs_by_user = defaultdict(list)\n  for user, song in user_song_pairs:\n    songs_by_user[user].append(song)\n    \n  return songs_by_user\n  \n\ndef get_user_history(user_ids):\n  \"\"\"Return \"\"\"\n  user_history = ratings.filter(lambda x: x[0] in user_ids).collect()\n  return user_history\n\n# TODO: Output the preferences of users as track names\ndef get_recommendations_by_user(user_ids, num_recs=100, only_new_songs=True, path_to_model='/mnt/S3/models/good_model'):\n  \"\"\"\n  Return recommendations of the model for users.\n  model - a MatrixFactorization object\n  user_ids - list of integers\n  num_recs - the number of recommendations. default is 100.\n  only_new_songs - Only recommend songs users haven't heard?\n  \"\"\"\n\n  # Get the user recommendations and history\n  user_recommendations = get_model_recommendations(path_to_model, user_ids, num_recs)\n  user_history = get_user_history(user_ids)\n  \n  # Don't need the rating\n  user_recommendations = [(x[0], x[1]) for x in user_recommendations]\n  user_history = [(x[0], x[1]) for x in user_history]\n  \n  if only_new_songs:\n    # Get the set difference between recommendations and history\n    # user_recommendations = user_recommendations - user_history\n    user_recommendations = [r for r in user_recommendations if r not in user_history ]\n    \n  return get_song_names_by_user(user_recommendations)\n\ndef get_model_recommendations(path_to_model, user_ids, num_recs):\n  \"\"\"Get a list of recommendations for a list of users\"\"\"\n  \n  model = MatrixFactorizationModel.load(sc, path_to_model)\n  recommendations = []\n  for user_id in user_ids:\n    recommendations.extend(model.recommendProducts(user_id, num_recs))\n  return recommendations\n\ndef remove_nas(l):\n  \"\"\"Remove NAs from list\"\"\"\n  return [e for e in l if not e == 'N/A']\n\ndef spotify_ids_to_ratings_file(user_id, path_to_spotify_ids, path_to_output):\n  \"\"\"Convert a file of spotify ids to a ratings file\"\"\"\n  \n  # Load spotify mappings\n  path_to_mappings = \"/mnt/S3/processed_data/spotify_mappings/*\"\n  spotify_mappings = sc.textFile(path_to_mappings).map(lambda x: x.split(',')).map(lambda x: (x[1].strip(), x[0]))\n  \n  # Load spotify ids\n  # Create dummy variable for (key, val) format\n  spotify_ids = spark.read.csv(path=path_to_spotify_ids, header=True).rdd.map(lambda x: (x[0], 0))\n  \n  # Join spotify ids with spotify_mappings\n  user_song_mappings = spotify_mappings.join(spotify_ids).collect()\n  \n  # Select msd ids\n  msd_ids = [x[1][0] for x in user_song_mappings]\n  \n  # Convert to model ids\n  kaggle_songs_path = os.path.join(datapath, \"raw_data/fromKaggle/kaggle_songs.txt\")\n  song_ids_list = sc.textFile(kaggle_songs_path)\\\n      .map(lambda x: x.split())\\\n      .map(lambda x: (int(x[1]), x[0]))\\\n      .filter(lambda x: x[1] in msd_ids)\\\n      .map(lambda x: x[0])\\\n      .collect()\n      \n  # Create ratings\n  ratings = sc.parallelize(song_ids_list).map(lambda x: str(user_id) + ', ' + str(x) + ', ' + str(1.0))\n  \n  # Export to file\n  ratings.repartition(1).saveAsTextFile(path_to_output)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax","error":"<div class=\"ansiout\"><span class=\"ansicyan\">  File </span><span class=\"ansigreen\">&quot;&lt;ipython-input-69-15d47a8a6936&gt;&quot;</span><span class=\"ansicyan\">, line </span><span class=\"ansigreen\">129</span>\n<span class=\"ansiyellow\">    user_recommendations = [r if r not in user_history for r in user_recommendations]</span>\n<span class=\"ansigrey\">                                                         ^</span>\n<span class=\"ansired\">SyntaxError</span><span class=\"ansired\">:</span> invalid syntax\n\n</div>","workflows":[],"startTime":1.482017250325E12,"submitTime":1.482017196179E12,"finishTime":1.482017250618E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b7afb92e-a255-4465-9188-1110cad4ea77"},{"version":"CommandV1","origId":1212,"guid":"8a9334c6-e9a0-44b0-95a0-00e017963ab4","subtype":"command","commandType":"auto","position":7.5,"command":"%md # Create Custom Rating Files","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7bafe304-898f-4c0b-8017-46888d953d7d"},{"version":"CommandV1","origId":1213,"guid":"87262722-e7a6-4198-acd4-b1c7c7ace1ea","subtype":"command","commandType":"auto","position":7.75,"command":"spotify_ids_to_ratings_file(2000000, \"/mnt/S3/raw_data/spotify_users/josh_spotify.csv\", \"/mnt/S3/processed_data/josh_ratings.txt\")\nspotify_ids_to_ratings_file(3000000, \"/mnt/S3/raw_data/spotify_users/oamar_spotify.csv\", \"/mnt/S3/processed_data/oamar_ratings.txt\")\nspotify_ids_to_ratings_file(4000000, \"/mnt/S3/raw_data/spotify_users/james_spotify.csv\", \"/mnt/S3/processed_data/james_ratings.txt\")","commandVersion":0,"state":"error","results":null,"errorSummary":"org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory dbfs:/mnt/S3/processed_data/james_ratings.txt already exists","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-5-3f44b94c05c0&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\">#spotify_ids_to_ratings_file(2000000, &quot;/mnt/S3/raw_data/spotify_users/josh_spotify.csv&quot;, &quot;/mnt/S3/processed_data/josh_ratings.txt&quot;)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      2</span> <span class=\"ansired\">#spotify_ids_to_ratings_file(3000000, &quot;/mnt/S3/raw_data/spotify_users/oamar_spotify.csv&quot;, &quot;/mnt/S3/processed_data/oamar_ratings.txt&quot;)</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 3</span><span class=\"ansiyellow\"> </span>spotify_ids_to_ratings_file<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">4000000</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;/mnt/S3/raw_data/spotify_users/james_spotify.csv&quot;</span><span class=\"ansiyellow\">,</span> <span class=\"ansiblue\">&quot;/mnt/S3/processed_data/james_ratings.txt&quot;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">&lt;ipython-input-2-aa0b485ab9c0&gt;</span> in <span class=\"ansicyan\">spotify_ids_to_ratings_file</span><span class=\"ansiblue\">(user_id, path_to_spotify_ids, path_to_output)</span>\n<span class=\"ansigreen\">    168</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    169</span>   <span class=\"ansired\"># Export to file</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 170</span><span class=\"ansiyellow\">   </span>ratings<span class=\"ansiyellow\">.</span>repartition<span class=\"ansiyellow\">(</span><span class=\"ansicyan\">1</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>saveAsTextFile<span class=\"ansiyellow\">(</span>path_to_output<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.pyc</span> in <span class=\"ansicyan\">saveAsTextFile</span><span class=\"ansiblue\">(self, path, compressionCodecClass)</span>\n<span class=\"ansigreen\">   1517</span>             keyed<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>ctx<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>BytesToString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>saveAsTextFile<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">,</span> compressionCodec<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1518</span>         <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">-&gt; 1519</span><span class=\"ansiyellow\">             </span>keyed<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>ctx<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>BytesToString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>saveAsTextFile<span class=\"ansiyellow\">(</span>path<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1520</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1521</span>     <span class=\"ansired\"># Pair functions</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.3-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.pyc</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.3-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling o434.saveAsTextFile.\n: org.apache.hadoop.mapred.FileAlreadyExistsException: Output directory dbfs:/mnt/S3/processed_data/james_ratings.txt already exists\n\tat org.apache.hadoop.mapred.FileOutputFormat.checkOutputSpecs(FileOutputFormat.java:131)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply$mcV$sp(PairRDDFunctions.scala:1184)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply(PairRDDFunctions.scala:1161)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopDataset$1.apply(PairRDDFunctions.scala:1161)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n\tat org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopDataset(PairRDDFunctions.scala:1161)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply$mcV$sp(PairRDDFunctions.scala:1064)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1030)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$4.apply(PairRDDFunctions.scala:1030)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n\tat org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:1030)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply$mcV$sp(PairRDDFunctions.scala:956)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:956)\n\tat org.apache.spark.rdd.PairRDDFunctions$$anonfun$saveAsHadoopFile$1.apply(PairRDDFunctions.scala:956)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n\tat org.apache.spark.rdd.PairRDDFunctions.saveAsHadoopFile(PairRDDFunctions.scala:955)\n\tat org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply$mcV$sp(RDD.scala:1459)\n\tat org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply(RDD.scala:1438)\n\tat org.apache.spark.rdd.RDD$$anonfun$saveAsTextFile$1.apply(RDD.scala:1438)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n\tat org.apache.spark.rdd.RDD.saveAsTextFile(RDD.scala:1438)\n\tat org.apache.spark.api.java.JavaRDDLike$class.saveAsTextFile(JavaRDDLike.scala:549)\n\tat org.apache.spark.api.java.AbstractJavaRDDLike.saveAsTextFile(JavaRDDLike.scala:45)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:237)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\n\n</div>","workflows":[],"startTime":1.482017530651E12,"submitTime":1.482017530651E12,"finishTime":1.482017537211E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6e5b027e-a12d-4d81-b8b4-1453682736c1"},{"version":"CommandV1","origId":1044,"guid":"09bbcc04-582b-407e-96a0-99bbdff4eee5","subtype":"command","commandType":"auto","position":8.0,"command":"%md # Conversion Sample Usage","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9092875c-4e51-43df-8c7c-4791f29c09c9"},{"version":"CommandV1","origId":1046,"guid":"6cd0a309-7e00-4f04-9ec0-18b003d43940","subtype":"command","commandType":"auto","position":8.5,"command":"%md ## Return randomly sampled song details","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"eed24fd7-5a60-43f0-bd40-39b45a3de6cf"},{"version":"CommandV1","origId":1037,"guid":"d9514c8f-5202-4059-80fa-40c1b2361da7","subtype":"command","commandType":"auto","position":9.0,"command":"from pyspark.sql.types import *\n\n# Sample some song ids\nnum_songs = 10\n\n# Load and parse data\nkaggle_songs_path = os.path.join(datapath, \"raw_data/fromKaggle/kaggle_songs.txt\")\n\n# Create songs DF\nsongsSchema = StructType([StructField(\"songId\", StringType(), True),\n                           StructField(\"songInt\", IntegerType(), True)])\nsongsDF = spark.read.csv(path=kaggle_songs_path, sep=\" \", schema=songsSchema)\n\nrec_ids = songsDF.rdd.map(lambda x: x[1]).takeSample(False, num_songs, seed=0)\n\nprint \"Song details:\"\nprint get_song_details(rec_ids)\n\nprint \"Spotify ids:\"\nprint get_spotify_ids(rec_ids)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Song details:\n[(u&apos;SOMFKMX13105FA4862&apos;, u&apos;spotify:track:3m0FvjdRwjBkGSb4cR6adD&apos;, u&apos;Yesterdays Rising&apos;, u&apos;catastrophic&apos;), (u&apos;SOCQTQU131712D1174&apos;, u&apos;spotify:track:735YD5j5e6yy3YyrQY5bNo&apos;, u&apos;Dan Zanes&apos;, u&apos;The Mermaid&apos;), (u&apos;SOBGLXD12A8C1387D9&apos;, u&apos;spotify:track:4jJfUcgntpychFcguGUgvz&apos;, u&apos;Sons and Daughters&apos;, u&apos;The Party&apos;), None, (u&apos;SOVVKYA12A67ADAB44&apos;, u&apos;spotify:track:0KPyYWfKcrSAzrEbT10sLP&apos;, u&apos;Borknagar&apos;, u&apos;To Mount And Rove&apos;), (u&apos;SOOQJWC12AB017E6BC&apos;, u&apos;spotify:track:4MR6vomhSF2IuK8KrMWOMo&apos;, u&apos;1990s&apos;, u&apos;59&apos;), None, (u&apos;SOESGLB12A8C13D13D&apos;, u&apos;spotify:track:4lqd6wZWwUIsVwdXeHKBHC&apos;, u&apos;Def Con Dos&apos;, u&apos;Dimelo Tu&apos;), (u&apos;SODAUHK12AB01837BB&apos;, u&apos;spotify:track:3C7DQZNbm1vpyAf6ujJjon&apos;, u&apos;Grieves&apos;, u&apos;Greedy Bitch&apos;), None]\nSpotify ids:\n[u&apos;spotify:track:3m0FvjdRwjBkGSb4cR6adD&apos;, u&apos;spotify:track:735YD5j5e6yy3YyrQY5bNo&apos;, u&apos;spotify:track:4jJfUcgntpychFcguGUgvz&apos;, u&apos;spotify:track:0KPyYWfKcrSAzrEbT10sLP&apos;, u&apos;spotify:track:4MR6vomhSF2IuK8KrMWOMo&apos;, u&apos;spotify:track:4lqd6wZWwUIsVwdXeHKBHC&apos;, u&apos;spotify:track:3C7DQZNbm1vpyAf6ujJjon&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"org.apache.spark.SparkException: Job aborted due to stage failure: Task 3 in stage 57.0 failed 4 times, most recent failure: Lost task 3.3 in stage 57.0 (TID 1675, 10.172.246.24): org.apache.spark.api.python.PythonException: Traceback (most recent call last):","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">Py4JJavaError</span>                             Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-37-d235a5ae3f1c&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">     23</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     24</span> song_files <span class=\"ansiyellow\">=</span> sc<span class=\"ansiyellow\">.</span>textFile<span class=\"ansiyellow\">(</span><span class=\"ansiblue\">&apos;,&apos;</span><span class=\"ansiyellow\">.</span>join<span class=\"ansiyellow\">(</span>path_to_song_files<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 25</span><span class=\"ansiyellow\"> </span>song_details <span class=\"ansiyellow\">=</span> song_files<span class=\"ansiyellow\">.</span>map<span class=\"ansiyellow\">(</span><span class=\"ansigreen\">lambda</span> x<span class=\"ansiyellow\">:</span> get_song_info<span class=\"ansiyellow\">(</span>x<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">.</span>collect<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/rdd.py</span> in <span class=\"ansicyan\">collect</span><span class=\"ansiblue\">(self)</span>\n<span class=\"ansigreen\">    774</span>         &quot;&quot;&quot;\n<span class=\"ansigreen\">    775</span>         <span class=\"ansigreen\">with</span> SCCallSiteSync<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>context<span class=\"ansiyellow\">)</span> <span class=\"ansigreen\">as</span> css<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 776</span><span class=\"ansiyellow\">             </span>port <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>ctx<span class=\"ansiyellow\">.</span>_jvm<span class=\"ansiyellow\">.</span>PythonRDD<span class=\"ansiyellow\">.</span>collectAndServe<span class=\"ansiyellow\">(</span>self<span class=\"ansiyellow\">.</span>_jrdd<span class=\"ansiyellow\">.</span>rdd<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    777</span>         <span class=\"ansigreen\">return</span> list<span class=\"ansiyellow\">(</span>_load_from_socket<span class=\"ansiyellow\">(</span>port<span class=\"ansiyellow\">,</span> self<span class=\"ansiyellow\">.</span>_jrdd_deserializer<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    778</span> <span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.3-src.zip/py4j/java_gateway.py</span> in <span class=\"ansicyan\">__call__</span><span class=\"ansiblue\">(self, *args)</span>\n<span class=\"ansigreen\">   1131</span>         answer <span class=\"ansiyellow\">=</span> self<span class=\"ansiyellow\">.</span>gateway_client<span class=\"ansiyellow\">.</span>send_command<span class=\"ansiyellow\">(</span>command<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1132</span>         return_value = get_return_value(\n<span class=\"ansigreen\">-&gt; 1133</span><span class=\"ansiyellow\">             answer, self.gateway_client, self.target_id, self.name)\n</span><span class=\"ansigreen\">   1134</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">   1135</span>         <span class=\"ansigreen\">for</span> temp_arg <span class=\"ansigreen\">in</span> temp_args<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansicyan\">deco</span><span class=\"ansiblue\">(*a, **kw)</span>\n<span class=\"ansigreen\">     61</span>     <span class=\"ansigreen\">def</span> deco<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     62</span>         <span class=\"ansigreen\">try</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">---&gt; 63</span><span class=\"ansiyellow\">             </span><span class=\"ansigreen\">return</span> f<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">*</span>a<span class=\"ansiyellow\">,</span> <span class=\"ansiyellow\">**</span>kw<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     64</span>         <span class=\"ansigreen\">except</span> py4j<span class=\"ansiyellow\">.</span>protocol<span class=\"ansiyellow\">.</span>Py4JJavaError <span class=\"ansigreen\">as</span> e<span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">     65</span>             s <span class=\"ansiyellow\">=</span> e<span class=\"ansiyellow\">.</span>java_exception<span class=\"ansiyellow\">.</span>toString<span class=\"ansiyellow\">(</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansigreen\">/databricks/spark/python/lib/py4j-0.10.3-src.zip/py4j/protocol.py</span> in <span class=\"ansicyan\">get_return_value</span><span class=\"ansiblue\">(answer, gateway_client, target_id, name)</span>\n<span class=\"ansigreen\">    317</span>                 raise Py4JJavaError(\n<span class=\"ansigreen\">    318</span>                     <span class=\"ansiblue\">&quot;An error occurred while calling {0}{1}{2}.\\n&quot;</span><span class=\"ansiyellow\">.</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">--&gt; 319</span><span class=\"ansiyellow\">                     format(target_id, &quot;.&quot;, name), value)\n</span><span class=\"ansigreen\">    320</span>             <span class=\"ansigreen\">else</span><span class=\"ansiyellow\">:</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">    321</span>                 raise Py4JError(\n\n<span class=\"ansired\">Py4JJavaError</span>: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.collectAndServe.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 3 in stage 57.0 failed 4 times, most recent failure: Lost task 3.3 in stage 57.0 (TID 1675, 10.172.246.24): org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 172, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 167, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;&lt;ipython-input-37-d235a5ae3f1c&gt;&quot;, line 25, in &lt;lambda&gt;\n  File &quot;&lt;ipython-input-36-37075d51ae11&gt;&quot;, line 11, in get_song_info\nIndexError: list index out of range\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:283)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:70)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:86)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:274)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1454)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1442)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1441)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:47)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1441)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:811)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:811)\n\tat scala.Option.foreach(Option.scala:236)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:811)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1667)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1622)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1611)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:632)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1891)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1904)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1917)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:1931)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:912)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:358)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:911)\n\tat org.apache.spark.api.python.PythonRDD$.collectAndServe(PythonRDD.scala:453)\n\tat org.apache.spark.api.python.PythonRDD.collectAndServe(PythonRDD.scala)\n\tat sun.reflect.GeneratedMethodAccessor93.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:237)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:280)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.spark.api.python.PythonException: Traceback (most recent call last):\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 172, in main\n    process()\n  File &quot;/databricks/spark/python/pyspark/worker.py&quot;, line 167, in process\n    serializer.dump_stream(func(split_index, iterator), outfile)\n  File &quot;/databricks/spark/python/pyspark/serializers.py&quot;, line 263, in dump_stream\n    vs = list(itertools.islice(iterator, batch))\n  File &quot;&lt;ipython-input-37-d235a5ae3f1c&gt;&quot;, line 25, in &lt;lambda&gt;\n  File &quot;&lt;ipython-input-36-37075d51ae11&gt;&quot;, line 11, in get_song_info\nIndexError: list index out of range\n\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.read(PythonRDD.scala:193)\n\tat org.apache.spark.api.python.PythonRunner$$anon$1.&lt;init&gt;(PythonRDD.scala:234)\n\tat org.apache.spark.api.python.PythonRunner.compute(PythonRDD.scala:152)\n\tat org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:63)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:319)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:283)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:70)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:86)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:274)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n</div>","workflows":[],"startTime":1.481994466561E12,"submitTime":1.481994465105E12,"finishTime":1.48199447249E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"00fbf22b-ee78-40bb-a621-bc68974819a4"},{"version":"CommandV1","origId":1066,"guid":"85aae5c8-a9f7-4f7f-9fb0-0826434b71b9","subtype":"command","commandType":"auto","position":9.5,"command":"%md ## See a user's listening history and their recommendations","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4d325ad8-0661-45db-85ff-00f917c28670"},{"version":"CommandV1","origId":1070,"guid":"81f5608d-fc8f-4cd3-8eb5-b33dca338644","subtype":"command","commandType":"auto","position":11.5,"command":"num_users = 3\nusers_subset = users.takeSample(False, num_users, seed=100)\nuser_history = get_history_by_user(users_subset)\n\nfor user_id, history in user_history.iteritems():\n  print \"User:\", user_id\n  print \"History:\", history","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">User: 866456\nHistory: [u&apos;The Hold Steady - Slapped Actress&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Sepultura - Manifest&apos;, &apos;N/A&apos;, u&apos;Ghostface Killah - We Celebrate featuring Kid Capri (Album Version (Explicit))&apos;, u&apos;The Whigs - Technology&apos;, &apos;N/A&apos;, u&apos;Airto Moreira - Berimbau First Cry&apos;, u&apos;Atomic Kitten - Whole Again&apos;, u&apos;Taking Back Sunday - Head Club&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Vampire Weekend - M79&apos;, u&apos;Yeah Yeah Yeahs - Dudley&apos;, u&apos;Kiss - Murder In High-Heels&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Koop - Tonight&apos;, u&apos;The Notorious B.I.G. - Let Me Get Down&apos;, u&apos;Wu-Tang Clan - Visionz&apos;, u&quot;Wu-Tang Clan - Da Mystery Of Chessboxin&apos;&quot;, u&quot;T.I. - I&apos;m Talkin&apos; To You&quot;, &apos;N/A&apos;, u&apos;Ghostface Killah - Rec-Room Therapy&apos;, u&apos;Big Tymers - Sunny Day&apos;]\nUser: 405566\nHistory: [&apos;N/A&apos;, u&apos;Iration - Time Bomb&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Newton Faulkner - Lipstick Jungle&apos;, u&apos;hellogoodbye - Shimmy Shimmy Quarter Turn (Take It Back To Square One)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;O.G.C. - Gunn Clapp&apos;, u&apos;Lupe Fiasco - Fighters (feat. Matthew Santos) (Explicit Album Version)&apos;, u&quot;Alvin And The Chipmunks - Get You Goin&apos;&quot;, &apos;N/A&apos;, u&quot;Mae - Someone Else&apos;s Arms&quot;, u&apos;The Postal Service - Brand New Colony&apos;, u&apos;Lupe Fiasco - Paris, Tokyo&apos;, u&apos;The Casualties - Fight For Your Life&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;blink-182 - Always&apos;, &apos;N/A&apos;, u&apos;The Terrible Twos - Great Big Poop&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&quot;Far Corner - Do You Think I&apos;m Spooky?&quot;, &apos;N/A&apos;, u&apos;Beastie Boys - Intergalactic (Digitally Remastered 99)&apos;, &apos;N/A&apos;, u&apos;Coldplay - Yellow&apos;, &apos;N/A&apos;, u&apos;Maroon 5 - Nothing Lasts Forever&apos;, u&apos;Rise Against - Swing Life Away&apos;, &apos;N/A&apos;, u&apos;Jack Johnson - Bubble Toes&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Raphael - Ne Partons Pas F\\xe2ch\\xe9s&apos;, u&apos;Kings of Leon - Milk&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Jack Johnson - Posters&apos;]\nUser: 871502\nHistory: [&apos;N/A&apos;, u&apos;The Chiffons - Three Dips of Ice Cream&apos;, u&apos;Dru Hill - Old Love&apos;, u&apos;Diddy - Angels With Dirty Faces&apos;, &apos;N/A&apos;, u&apos;Dru Hill - I Do (Millions)&apos;, &apos;N/A&apos;, u&apos;Rick Astley - Never Gonna Give You Up&apos;, u&apos;Foo Fighters - Band On The Run&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Plies - Ms. Pretty Pussy&apos;, &apos;N/A&apos;, u&apos;Ernest Ranglin - Three Pope (feat. Monty Alexander)&apos;, u&apos;Dru Hill - Men Always Regret&apos;, u&quot;Gary Burton - I&apos;m Your Pal&quot;, u&apos;Faith Evans - Reasons&apos;, u&apos;Westside Connection - Bow Down&apos;, u&apos;Silk - Lose Control&apos;, &apos;N/A&apos;, u&quot;Tiken Jah Fakoly - Ma C\\xf4te D&apos;Ivoire&quot;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;The Undertones - My Perfect Cousin&apos;, u&quot;Mae - Someone Else&apos;s Arms&quot;, u&apos;Matteah Baim - Michael Row&apos;, &apos;N/A&apos;, u&apos;Robin Thicke - Meipl\\xe9 featuring JAY-Z&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Alphonse Mouzon - Sunflower (aka Sunshower)&apos;, &apos;N/A&apos;, u&apos;Dru Hill - She Said&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&quot;Dru Hill - Love&apos;s Train&quot;, u&apos;Dru Hill - What Do I Do With The Love&apos;, u&apos;Campo - Mi Coraz\\xf3n (Marcelo Castelli Remix)&apos;, &apos;N/A&apos;, u&quot;L&apos;\\xc2ME IMMORTELLE - Brother Against Brother&quot;, u&apos;Black Moth Super Rainbow - I Am The Alphabet&apos;, u&apos;Dave Hollister - My Favorite Girl&apos;, u&apos;Dru Hill - I Should Be...&apos;, &apos;N/A&apos;, u&apos;Jay-Z - Dead Presidents II&apos;, u&apos;Diddy - I Need A Girl (Part One) (Featuring Usher &amp; Loon)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;R. Kelly - Showdown&apos;, &apos;N/A&apos;, u&apos;Future Rock - Gears&apos;, &apos;N/A&apos;, u&apos;Dru Hill - Nowhere Without You (Interlude)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;New Edition - Something About You&apos;, &apos;N/A&apos;, u&apos;Carl Thomas - Emotional&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Boyz II Men - Can You Stand The Rain&apos;, u&quot;N.W.A - I&apos;d Rather Fuck You (Feat. Eazy-E)&quot;, &apos;N/A&apos;, u&apos;Dru Hill - One Good Reason&apos;, &apos;N/A&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.481994807744E12,"submitTime":1.481994806301E12,"finishTime":1.481994807784E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6d90ceb7-f1a0-4189-8149-09a2351d34d1"},{"version":"CommandV1","origId":1056,"guid":"c91efe78-f4ff-450a-a841-67b52048e66a","subtype":"command","commandType":"auto","position":15.0,"command":"# What are the users recommendations?\nrecommendations_new = get_recommendations_by_user(users_subset, num_recs=100, only_new_songs=True)\nrecommendations_all = get_recommendations_by_user(users_subset, num_recs=100, only_new_songs=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">NameError</span>: name &apos;get_recommendations_by_user&apos; is not defined","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">NameError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-300-dcdf36e02025&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      2</span> user_ids <span class=\"ansiyellow\">=</span> <span class=\"ansiyellow\">[</span><span class=\"ansicyan\">768902</span><span class=\"ansiyellow\">]</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> <span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 4</span><span class=\"ansiyellow\"> </span>recommendations_new <span class=\"ansiyellow\">=</span> get_recommendations_by_user<span class=\"ansiyellow\">(</span>user_ids<span class=\"ansiyellow\">,</span> num_recs<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">100</span><span class=\"ansiyellow\">,</span> only_new_songs<span class=\"ansiyellow\">=</span>True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      5</span> recommendations_all <span class=\"ansiyellow\">=</span> get_recommendations_by_user<span class=\"ansiyellow\">(</span>user_ids<span class=\"ansiyellow\">,</span> num_recs<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">100</span><span class=\"ansiyellow\">,</span> only_new_songs<span class=\"ansiyellow\">=</span>True<span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">NameError</span>: name &apos;get_recommendations_by_user&apos; is not defined\n</div>","workflows":[],"startTime":1.481995080743E12,"submitTime":1.481995079232E12,"finishTime":1.481995231681E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"55e933ae-1e7b-48f6-b345-44c48aeb10fd"},{"version":"CommandV1","origId":1095,"guid":"6ae3e6e1-ec23-475b-b378-b9eb72923b0a","subtype":"command","commandType":"auto","position":15.75,"command":"# Get user recommendations\nprint \"New Recommendations:\"\nfor user_id, recommendations in recommendations_new.iteritems():\n  print \"User:\", user_id\n  print \"Recommendations:\", recommendations\n  \nprint \"All Recommendations:\"\nfor user_id, recommendations in recommendations_all.iteritems():\n  print \"User:\", user_id\n  print \"Recommendations:\", recommendations","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">New Recommendations:\nUser: 866456\nRecommendations: [u&apos;Tom Petty and The Heartbreakers - Into The Great Wide Open&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Queen - Love Of My Life&apos;, u&apos;The Modern Lovers - Modern World&apos;, u&quot;Mae - Someone Else&apos;s Arms&quot;, &apos;N/A&apos;, u&apos;Pixies - Velouria&apos;, &apos;N/A&apos;, u&quot;Future Loop Foundation - What&apos;s Your Name&quot;, u&apos;David Crowder Band - Only You (Illuminate Album Version)&apos;, u&apos;Tom Petty and The Heartbreakers - Learning To Fly&apos;, u&apos;The Black Crowes - Greenhorn&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Faith No More - Midlife Crisis&apos;, &apos;N/A&apos;, u&apos;Four Year Strong - Heroes Get Remembered, Legends Never Die&apos;, &apos;N/A&apos;, u&quot;Jay-Z - D&apos;Evils&quot;, &apos;N/A&apos;, u&apos;Hork\\xfd\\u017ee Sl\\xed\\u017ee - Fakty&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kid Cudi - Sky Might Fall&apos;, u&apos;The Notorious B.I.G. - Kick In The Door (Soundtrack Version) (Explicit)&apos;, u&apos;Lil Wayne - One Way Trip&apos;, &apos;N/A&apos;, u&apos;Sauce Money - What We Do (Feat. Memphis Bleek)&apos;, u&apos;The Notorious B.I.G. - Suicidal Thoughts&apos;, &apos;N/A&apos;, u&apos;Faith No More - Just A Man&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;The Notorious B.I.G. - Come On&apos;, &apos;N/A&apos;, u&apos;The Undertones - My Perfect Cousin&apos;, u&apos;Silhouette Brown - Strawberries In Vinegar&apos;, u&apos;Les Savy Fav - Bringing Us Down&apos;, u&apos;Cartola - Sala De Recep\\xe7\\xe3o&apos;, &apos;N/A&apos;, u&quot;Lil Wayne - Ain&apos;t That A Bitch (Album Version (Edited))&quot;, u&quot;The Notorious B.I.G. - Can I Get Wit&apos;cha&quot;, u&apos;59 Times the Pain - Found Home&apos;, &apos;N/A&apos;, u&apos;Kid Cudi - Cudi Zone&apos;, &apos;N/A&apos;, u&quot;Hannah Montana - What&apos;s Not To Like&quot;, u&apos;Bohren &amp; der Club of Gore - Schwarze Biene (Black Maja)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Thievery Corporation - Until The Morning&apos;, u&quot;Jacky Terrasson - Le Jardin d&apos;Hiver&quot;, u&apos;Yung Joc - Dope Boy Magic [Feat. Nicholas &quot;Play Boy Nick&quot; Smith, Corey &quot;Black Owned C Bone&quot; Andrews and Chino Dolla] [Explicit Album Version]&apos;, u&apos;Binary Star - Solar Powered (feat. One Be Lo &amp; Senim Silla)&apos;, u&quot;Olle Adolphson - En glad calypso om v\\xe5ren (Live &apos;62)&quot;, &apos;N/A&apos;, u&apos;Lil Wayne - American Star&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Jay-Z - So Ambitious [Jay-Z + Pharrell]&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kid Cudi - Simple As...&apos;, &apos;N/A&apos;, u&apos;blink-182 - Going Away To College&apos;, u&apos;Bohren &amp; der Club of Gore - Welk&apos;, u&apos;Wiz Khalifa - Ink My Whole Body&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;D12 - Bitch (Album Version (Edited))&apos;, u&apos;a-ha - Touchy!&apos;, u&apos;The Bonzo Dog Band - Alley Oop (Girls Version) (2007 Digital Remaster)&apos;, u&quot;Jay-Z - Heart Of The City (Ain&apos;t No Love)&quot;, u&apos;Days of the New - Dirty Road&apos;, u&quot;Britney Spears - Can&apos;t Make You Love Me&quot;, u&apos;Mystikal - Alright&apos;, u&apos;Neil Young - Love And Only Love (1991 Live LP Version)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Ryan Adams - Stop&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;+/- {Plus/Minus} - The Queen of Nothing&apos;, u&apos;Birdman - Money To Blow (Street Version)&apos;, u&apos;Angels &amp; Airwaves - Breathe&apos;, &apos;N/A&apos;]\nUser: 871502\nRecommendations: [&apos;N/A&apos;, &apos;N/A&apos;, u&apos;Nick Lowe - All Men Are Liars&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Revl9n - Someone Like You&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kalafut - Novocaine (Mark Otten remix)&apos;, u&apos;Dorothy Love Coates - Elijah&apos;, u&apos;Q-Burns Abstract Message - This Time&apos;, u&apos;Aaliyah - Rock The Boat&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;J. Holiday - Suffocate&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Dirty Wormz - Top Of The Food Chain&apos;, &apos;N/A&apos;, u&quot;Maxwell - This Woman&apos;s Work&quot;, u&apos;Trey Songz - Panty Droppa [Intro]&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Musiq Soulchild - teachme&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Mariah Carey - One Sweet Day&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Silver Mountain Reveries - Microphones In The Trees&apos;, u&quot;Dru Hill - We&apos;re Not Making Love No More&quot;, &apos;N/A&apos;, u&apos;Days of the New - Provider&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Aaliyah - Miss You&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Silk - Freak Me&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Death in Vegas - Girls&apos;, u&apos;The Casualties - Fight For Your Life&apos;, &apos;N/A&apos;, u&quot;Jagged Edge - LET&apos;S GET MARRIED (Intro Version)&quot;, &apos;N/A&apos;, u&apos;DeGarmo &amp; Key - When The Son Begins To Reign (Degarmo And Key Album Version)&apos;, &apos;N/A&apos;, u&apos;Jeff Buckley - Opened Once&apos;, u&apos;Westlife - You Raise Me Up&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;C.V. J\\xf8rgensen - I Skyggen Som Jeg Plejer (1998 Digital Remaster)&apos;, &apos;N/A&apos;, u&apos;Alicia Keys - Lesson Learned&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Trey Songz - Love Lost&apos;, &apos;N/A&apos;, u&quot;Westside Connection - Hoo-Bangin&apos; (WSCG Style)&quot;, &apos;N/A&apos;]\nUser: 405566\nRecommendations: [&apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Chiddy Bang - Opposite Of Adults&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Sheena Easton - Strut&apos;, u&apos;Kid Cudi - Up Up &amp; Away&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kanye West - Street Lights&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Usher - There Goes My Baby&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&quot;B.o.B - Nothin&apos; On You (feat. Bruno Mars)&quot;, &apos;N/A&apos;, u&apos;Future Rock - Gears&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&quot;K&apos;naan - Take A Minute&quot;, u&apos;Barry Tuckwell - Horn Concerto No. 4 in E Flat, K.495: II. Romance (Andante cantabile)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;The White Stripes - Seven Nation Army&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;MGMT - Time to Pretend&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&apos;John Mayer - Neon (Live at the Nokia Theatre)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Jack Johnson - Times Like These&apos;, u&apos;Todd Barry - Sugar Ray&apos;, u&apos;John Mayer - Perfectly Lonely&apos;, &apos;N/A&apos;, u&quot;Band of Horses - No One&apos;s Gonna Love You&quot;, &apos;N/A&apos;, u&quot;Jacky Terrasson - Le Jardin d&apos;Hiver&quot;, u&quot;Cage the Elephant - Ain&apos;t No Rest For The Wicked&quot;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Colossal - Brave The Elements&apos;, u&apos;Jack Johnson - Do You Remember&apos;, &apos;N/A&apos;, u&apos;Jack Johnson - Breakdown&apos;, u&apos;Alliance Ethnik - Repr\\xe9sente&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;The Kooks - Naive&apos;, u&apos;Neil Young - Love And Only Love (1991 Live LP Version)&apos;, u&apos;The Killers - When You Were Young&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Travie McCoy - Billionaire&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kings of Leon - Revelry&apos;, u&apos;Angels &amp; Airwaves - The Gift&apos;, u&apos;Cosmo Vitelli - Robot Soul (Radio Edit)&apos;, &apos;N/A&apos;]\nAll Recommendations:\nUser: 866456\nRecommendations: [u&apos;Tom Petty and The Heartbreakers - Into The Great Wide Open&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Queen - Love Of My Life&apos;, u&apos;The Modern Lovers - Modern World&apos;, u&quot;Mae - Someone Else&apos;s Arms&quot;, &apos;N/A&apos;, u&apos;Pixies - Velouria&apos;, &apos;N/A&apos;, u&quot;Future Loop Foundation - What&apos;s Your Name&quot;, u&apos;David Crowder Band - Only You (Illuminate Album Version)&apos;, u&apos;Tom Petty and The Heartbreakers - Learning To Fly&apos;, u&apos;The Black Crowes - Greenhorn&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Faith No More - Midlife Crisis&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Four Year Strong - Heroes Get Remembered, Legends Never Die&apos;, &apos;N/A&apos;, u&quot;Jay-Z - D&apos;Evils&quot;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Hork\\xfd\\u017ee Sl\\xed\\u017ee - Fakty&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kid Cudi - Sky Might Fall&apos;, u&apos;The Notorious B.I.G. - Kick In The Door (Soundtrack Version) (Explicit)&apos;, u&apos;Lil Wayne - One Way Trip&apos;, &apos;N/A&apos;, u&apos;Sauce Money - What We Do (Feat. Memphis Bleek)&apos;, u&apos;The Notorious B.I.G. - Suicidal Thoughts&apos;, &apos;N/A&apos;, u&apos;Faith No More - Just A Man&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;The Notorious B.I.G. - Come On&apos;, &apos;N/A&apos;, u&apos;The Undertones - My Perfect Cousin&apos;, u&apos;Silhouette Brown - Strawberries In Vinegar&apos;, u&apos;Les Savy Fav - Bringing Us Down&apos;, u&apos;Cartola - Sala De Recep\\xe7\\xe3o&apos;, &apos;N/A&apos;, u&quot;Lil Wayne - Ain&apos;t That A Bitch (Album Version (Edited))&quot;, u&quot;The Notorious B.I.G. - Can I Get Wit&apos;cha&quot;, u&apos;59 Times the Pain - Found Home&apos;, &apos;N/A&apos;, u&apos;Kid Cudi - Cudi Zone&apos;, &apos;N/A&apos;, u&quot;Hannah Montana - What&apos;s Not To Like&quot;, u&apos;Bohren &amp; der Club of Gore - Schwarze Biene (Black Maja)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Thievery Corporation - Until The Morning&apos;, u&quot;Jacky Terrasson - Le Jardin d&apos;Hiver&quot;, u&apos;Yung Joc - Dope Boy Magic [Feat. Nicholas &quot;Play Boy Nick&quot; Smith, Corey &quot;Black Owned C Bone&quot; Andrews and Chino Dolla] [Explicit Album Version]&apos;, &apos;N/A&apos;, u&apos;Binary Star - Solar Powered (feat. One Be Lo &amp; Senim Silla)&apos;, u&quot;Olle Adolphson - En glad calypso om v\\xe5ren (Live &apos;62)&quot;, &apos;N/A&apos;, u&apos;Lil Wayne - American Star&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Jay-Z - So Ambitious [Jay-Z + Pharrell]&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kid Cudi - Simple As...&apos;, &apos;N/A&apos;, u&apos;blink-182 - Going Away To College&apos;, u&apos;Bohren &amp; der Club of Gore - Welk&apos;, u&apos;Wiz Khalifa - Ink My Whole Body&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;D12 - Bitch (Album Version (Edited))&apos;, u&apos;a-ha - Touchy!&apos;, u&apos;The Bonzo Dog Band - Alley Oop (Girls Version) (2007 Digital Remaster)&apos;, u&quot;Jay-Z - Heart Of The City (Ain&apos;t No Love)&quot;, u&apos;Big Tymers - Sunny Day&apos;, u&apos;Days of the New - Dirty Road&apos;, u&quot;Britney Spears - Can&apos;t Make You Love Me&quot;, u&apos;Mystikal - Alright&apos;, u&apos;Neil Young - Love And Only Love (1991 Live LP Version)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Ryan Adams - Stop&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;+/- {Plus/Minus} - The Queen of Nothing&apos;, u&apos;Birdman - Money To Blow (Street Version)&apos;, u&apos;Angels &amp; Airwaves - Breathe&apos;, &apos;N/A&apos;]\nUser: 871502\nRecommendations: [&apos;N/A&apos;, &apos;N/A&apos;, u&apos;Nick Lowe - All Men Are Liars&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Revl9n - Someone Like You&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kalafut - Novocaine (Mark Otten remix)&apos;, u&apos;Dorothy Love Coates - Elijah&apos;, u&apos;Q-Burns Abstract Message - This Time&apos;, u&apos;Aaliyah - Rock The Boat&apos;, &apos;N/A&apos;, u&apos;Diddy - I Need A Girl (Part One) (Featuring Usher &amp; Loon)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;J. Holiday - Suffocate&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Dirty Wormz - Top Of The Food Chain&apos;, &apos;N/A&apos;, u&quot;Maxwell - This Woman&apos;s Work&quot;, u&apos;Trey Songz - Panty Droppa [Intro]&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Musiq Soulchild - teachme&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&quot;Mae - Someone Else&apos;s Arms&quot;, u&apos;Mariah Carey - One Sweet Day&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Silver Mountain Reveries - Microphones In The Trees&apos;, u&quot;Dru Hill - We&apos;re Not Making Love No More&quot;, &apos;N/A&apos;, u&apos;Days of the New - Provider&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Aaliyah - Miss You&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Silk - Freak Me&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Death in Vegas - Girls&apos;, u&apos;The Casualties - Fight For Your Life&apos;, &apos;N/A&apos;, u&quot;Jagged Edge - LET&apos;S GET MARRIED (Intro Version)&quot;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;DeGarmo &amp; Key - When The Son Begins To Reign (Degarmo And Key Album Version)&apos;, &apos;N/A&apos;, u&apos;Jeff Buckley - Opened Once&apos;, u&apos;Westlife - You Raise Me Up&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;C.V. J\\xf8rgensen - I Skyggen Som Jeg Plejer (1998 Digital Remaster)&apos;, &apos;N/A&apos;, u&apos;Alicia Keys - Lesson Learned&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Trey Songz - Love Lost&apos;, &apos;N/A&apos;, u&quot;Westside Connection - Hoo-Bangin&apos; (WSCG Style)&quot;, &apos;N/A&apos;]\nUser: 405566\nRecommendations: [&apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Chiddy Bang - Opposite Of Adults&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Sheena Easton - Strut&apos;, u&apos;Kid Cudi - Up Up &amp; Away&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kanye West - Street Lights&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Usher - There Goes My Baby&apos;, &apos;N/A&apos;, u&apos;Lupe Fiasco - Paris, Tokyo&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&quot;B.o.B - Nothin&apos; On You (feat. Bruno Mars)&quot;, &apos;N/A&apos;, u&apos;Future Rock - Gears&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Jack Johnson - Bubble Toes&apos;, u&quot;K&apos;naan - Take A Minute&quot;, &apos;N/A&apos;, u&apos;Barry Tuckwell - Horn Concerto No. 4 in E Flat, K.495: II. Romance (Andante cantabile)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;The White Stripes - Seven Nation Army&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;MGMT - Time to Pretend&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&apos;John Mayer - Neon (Live at the Nokia Theatre)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Jack Johnson - Times Like These&apos;, u&apos;Todd Barry - Sugar Ray&apos;, u&apos;John Mayer - Perfectly Lonely&apos;, &apos;N/A&apos;, u&quot;Band of Horses - No One&apos;s Gonna Love You&quot;, &apos;N/A&apos;, u&quot;Jacky Terrasson - Le Jardin d&apos;Hiver&quot;, u&quot;Cage the Elephant - Ain&apos;t No Rest For The Wicked&quot;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Colossal - Brave The Elements&apos;, u&apos;Jack Johnson - Do You Remember&apos;, &apos;N/A&apos;, u&apos;Jack Johnson - Breakdown&apos;, &apos;N/A&apos;, u&apos;Alliance Ethnik - Repr\\xe9sente&apos;, &apos;N/A&apos;, u&apos;Lupe Fiasco - Fighters (feat. Matthew Santos) (Explicit Album Version)&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;The Kooks - Naive&apos;, u&apos;Neil Young - Love And Only Love (1991 Live LP Version)&apos;, u&apos;The Killers - When You Were Young&apos;, u&apos;Coldplay - Yellow&apos;, u&quot;Far Corner - Do You Think I&apos;m Spooky?&quot;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Travie McCoy - Billionaire&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, &apos;N/A&apos;, u&apos;Kings of Leon - Revelry&apos;, u&apos;Angels &amp; Airwaves - The Gift&apos;, u&apos;Cosmo Vitelli - Robot Soul (Radio Edit)&apos;, &apos;N/A&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.481995238036E12,"submitTime":1.481995236561E12,"finishTime":1.481995238107E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e9081d35-9bac-4710-9a4e-4c0831431db6"},{"version":"CommandV1","origId":1193,"guid":"c91623ff-6a45-4a6e-9a1d-19233f728ada","subtype":"command","commandType":"auto","position":17.75,"command":"%md # ","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"53e8c62b-f64b-42f0-b96b-46d39ffaf9ee"},{"version":"CommandV1","origId":1194,"guid":"8dcdce25-1f50-4b0b-a72f-974126b67ae3","subtype":"command","commandType":"auto","position":18.75,"command":"%md # Explore Homogeneous vs. Heterogeneous Groups","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"95fb5fbb-0ebb-479c-820c-b7ea4cb9f685"},{"version":"CommandV1","origId":1195,"guid":"3cb46f26-1878-4c98-ba2a-f2adb6dccd3c","subtype":"command","commandType":"auto","position":19.75,"command":"%md ## What are homogeneous group user histories?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6669237f-f378-4716-aff0-fad5103a5d53"},{"version":"CommandV1","origId":1196,"guid":"ef28ea49-1829-48dd-ab12-f9e5b774a6cc","subtype":"command","commandType":"auto","position":20.75,"command":"# Taken from clustering results\n# here are three groups of 3 members: [(84250, 722), (92650, 722), (193650, 722)], [(7550, 565), (178350, 565), (266450, 565)], [(322750, 814), (368450, 814), (461150, 814)]\n\n#homo_users = [126650, 174250, 383650]\nhomo_users = [84250, 92650, 193650]\nuser_history = get_history_by_user(homo_users)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.482000976457E12,"submitTime":1.482000975044E12,"finishTime":1.482001023565E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d1664ce6-452a-4693-a706-c125a6e5d630"},{"version":"CommandV1","origId":1201,"guid":"58f37b85-5b6c-4bd7-a820-2fc5e0d5a304","subtype":"command","commandType":"auto","position":21.25,"command":"for user_id, history in user_history.iteritems():\n  print \"User:\", user_id\n  print \"History:\", remove_nas(history)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">User: 84250\nHistory: [u&apos;Ghost Buffalo - The Magician&apos;, u&apos;Lifehouse - How Long&apos;, u&apos;Lifehouse - Undone&apos;, u&apos;Lifehouse - Whatever It Takes&apos;, u&quot;Lifehouse - We&apos;ll Never Know&quot;, u&apos;Lifehouse - Empty Space&apos;, u&apos;Lifehouse - By Your Side&apos;, u&apos;Lifehouse - Crash And Burn&apos;, u&apos;Lifehouse - Had Enough&apos;, u&apos;Lifehouse - Nerve Damage&apos;, u&apos;Lifehouse - Falling In&apos;, u&apos;Lifehouse - Into The Sun&apos;, u&apos;Lifehouse - Take Me Away&apos;, u&apos;Lifehouse - The Beginning&apos;, u&apos;Lifehouse - Anchor&apos;, u&apos;Lifehouse - Here Tomorrow Gone Today&apos;, u&apos;Lifehouse - Walking Away&apos;, u&apos;Lifehouse - Today&apos;, u&apos;Lifehouse - Storm&apos;, u&apos;Lifehouse - All In&apos;, u&apos;Lifehouse - The End Has Only Begun&apos;, u&apos;Lifehouse - Simon&apos;]\nUser: 92650\nHistory: [u&apos;Lifehouse - Whatever It Takes&apos;, u&apos;Lifehouse - Crash And Burn&apos;, u&apos;Lifehouse - Take Me Away&apos;, u&apos;Shakira - Underneath Your Clothes&apos;, u&apos;Dido - Thank You&apos;]\nUser: 193650\nHistory: [u&apos;Radiohead - Talk Show Host&apos;, u&apos;Radiohead - Just&apos;, u&apos;Radiohead - Sail To The Moon&apos;, u&apos;Lifehouse - Near Life Experience&apos;, u&apos;Radiohead - Melatonin&apos;, u&apos;Lifehouse - In Your Skin&apos;, u&apos;Lifehouse - How Long&apos;, u&apos;Radiohead - Sulk&apos;, u&apos;Lifehouse - Stanley Climbfall&apos;, u&apos;Lifehouse - Sky Is Falling&apos;, u&apos;Lifehouse - Undone&apos;, u&apos;Radiohead - Prove Yourself&apos;, u&apos;Lifehouse - It Is What It Is&apos;, u&apos;Radiohead - Lull&apos;, u&apos;Lifehouse - Whatever It Takes&apos;, u&apos;Lifehouse - From Where You Are&apos;, u&quot;Lifehouse - We&apos;ll Never Know&quot;, u&apos;Lifehouse - Just Another Name&apos;, u&apos;Lifehouse - Empty Space&apos;, u&apos;Lifehouse - Somewhere In Between&apos;, u&apos;Lifehouse - Wash&apos;, u&apos;Lifehouse - By Your Side&apos;, u&apos;Lifehouse - Crash And Burn&apos;, u&apos;Radiohead - A Reminder&apos;, u&apos;Lifehouse - Had Enough&apos;, u&apos;Radiohead - Bones&apos;, u&apos;Lifehouse - Nerve Damage&apos;, u&apos;Lifehouse - Smoke &amp; Mirrors&apos;, u&apos;Lifehouse - Sky Is Falling (Acoustic Version)&apos;, u&apos;Lifehouse - Falling In&apos;, u&apos;Lifehouse - Into The Sun&apos;, u&apos;Lifehouse - Am I Ever Gonna Find Out&apos;, u&apos;Lifehouse - Take Me Away&apos;, u&apos;Lifehouse - The Beginning&apos;, u&apos;Lifehouse - Anchor&apos;, u&apos;Lifehouse - Here Tomorrow Gone Today&apos;, u&apos;Five Iron Frenzy - Canada&apos;, u&apos;Lifehouse - Who We Are&apos;, u&apos;Lifehouse - Only One&apos;, u&apos;Lifehouse - Wrecking Ball&apos;, u&apos;Lifehouse - My Precious&apos;, u&apos;Kings of Leon - Revelry&apos;, u&apos;Radiohead - Exit Music (For A Film)&apos;, u&apos;Phoenix - Armistice (Yacht Remix)&apos;, u&quot;Lifehouse - All That I&apos;m Asking For&quot;, u&apos;Lifehouse - Walking Away&apos;, u&apos;Lifehouse - Today&apos;, u&apos;Lifehouse - Storm&apos;, u&apos;Lifehouse - All In&apos;, u&apos;Lifehouse - The End Has Only Begun&apos;, u&apos;Lifehouse - Simon&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.482001023569E12,"submitTime":1.482000980233E12,"finishTime":1.482001023639E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dff75511-ce8d-4e31-98d3-e743184cf32a"},{"version":"CommandV1","origId":1197,"guid":"5feb318c-fed9-4a03-ab75-61941dd97aee","subtype":"command","commandType":"auto","position":21.75,"command":"%md ## What are homogeneous group recommendations?","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"22b98ffc-f486-4e00-87c1-beff82fd448d"},{"version":"CommandV1","origId":1198,"guid":"f56beaf0-e383-4527-9564-e59a6be1ff29","subtype":"command","commandType":"auto","position":22.75,"command":"# What are the users recommendations?\nrecommendations_new = get_recommendations_by_user(homo_users, num_recs=100, only_new_songs=True)\nrecommendations_all = get_recommendations_by_user(homo_users, num_recs=100, only_new_songs=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.482002415563E12,"submitTime":1.482002414145E12,"finishTime":1.482002565634E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"157c79db-066f-4a52-8357-88830bb255f3"},{"version":"CommandV1","origId":1200,"guid":"46fd6b26-5c73-4b64-a788-c0f504ae0ce7","subtype":"command","commandType":"auto","position":23.75,"command":"# Get user recommendations\nprint \"New Recommendations:\"\nfor user_id, recommendations in recommendations_new.iteritems():\n  print \"User:\", user_id\n  print \"Recommendations:\", remove_nas(recommendations)\n  \nprint \"All Recommendations:\"\nfor user_id, recommendations in recommendations_all.iteritems():\n  print \"User:\", user_id\n  print \"Recommendations:\", remove_nas(recommendations)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">New Recommendations:\nUser: 84250\nRecommendations: [u&apos;Lifehouse - From Where You Are&apos;, u&apos;Lifehouse - It Is What It Is&apos;, u&apos;Godsmack - What If?&apos;, u&apos;Lifehouse - Somewhere In Between&apos;, u&quot;Lifehouse - All That I&apos;m Asking For&quot;, u&apos;Lifehouse - First Time&apos;, u&apos;Freeway - The Nation&apos;, u&apos;Lifehouse - Smoke &amp; Mirrors&apos;, u&quot;Anouk - It&apos;s So Hard&quot;, u&apos;Moving Hearts - Finore&apos;, u&apos;Lifehouse - Who We Are&apos;, u&apos;Lifehouse - Only One&apos;, u&apos;Lifehouse - In Your Skin&apos;, u&apos;Lifehouse - Wrecking Ball&apos;, u&apos;Lifehouse - Disarray&apos;, u&apos;Lifehouse - Easier To Be&apos;, u&apos;Lifehouse - Make Me Over&apos;, u&apos;Lifehouse - Near Life Experience&apos;, u&apos;Lifehouse - The Joke&apos;, u&apos;Lifehouse - All In All&apos;, u&apos;Lifehouse - Come Back Down&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&apos;OneRepublic - Mercy&apos;, u&apos;Lifehouse - Learn You Inside Out&apos;, u&apos;OneRepublic - All We Are&apos;, u&quot;Train - I&apos;m About To Come Alive&quot;, u&apos;Lifehouse - Sky Is Falling&apos;, u&apos;Bo Diddley - Pills&apos;, u&apos;Train - All I Ever Wanted&apos;, u&apos;Lifehouse - Am I Ever Gonna Find Out&apos;, u&apos;OneRepublic - All Fall Down&apos;, u&apos;Train - Give Myself To You&apos;, u&quot;Train - If I Can&apos;t Change Your Mind&quot;, u&quot;Train - For Me, It&apos;s You&quot;, u&apos;Lifehouse - Days Go By&apos;, u&apos;OneRepublic - Someone To Save You&apos;, u&apos;Lifehouse - Mesmerized&apos;, u&apos;OneRepublic - Goodbye, Apathy&apos;, u&apos;Lifehouse - Quasimodo&apos;, u&apos;Home Grown - Kiss Me, Diss Me&apos;, u&apos;Train - All I Hear&apos;, u&apos;Train - Always Remember&apos;, u&apos;Lifehouse - Stanley Climbfall&apos;, u&apos;Train - Shelter Me&apos;, u&apos;Train - Skyscraper&apos;, u&apos;Train - Ordinary (Rock Version)&apos;, u&quot;Train - I&apos;m Not Waiting In Line&quot;, u&apos;The Fray - Never Say Never&apos;, u&apos;Lifehouse - My Precious&apos;, u&apos;Lifehouse - Unknown&apos;, u&apos;matchbox twenty - Hand Me Down&apos;, u&apos;Train - Getaway&apos;, u&apos;Train - Get Out&apos;, u&apos;Lifehouse - Just Another Name&apos;, u&apos;Lifehouse - Cling And Clatter&apos;, u&apos;OneRepublic - Prodigal&apos;, u&apos;Lifehouse - Sky Is Falling (Acoustic Version)&apos;, u&apos;3 Doors Down - Be Somebody (Acoustic 2)&apos;, u&apos;Lifehouse - Bridges&apos;, u&apos;Train - Explanation&apos;, u&apos;OneRepublic - Made For You&apos;, u&apos;OneRepublic - Dreaming Out Loud&apos;, u&apos;OneRepublic - Fear&apos;, u&apos;Ry Cooder - Corrido de Boxeo&apos;, u&apos;The Fray - Heartless - Swinghouse Session&apos;]\nUser: 92650\nRecommendations: [u&apos;Lifehouse - From Where You Are&apos;, u&apos;Lifehouse - All In&apos;, u&apos;Lifehouse - Falling In&apos;, u&apos;Nickelback - Never Gonna Be Alone&apos;, u&apos;Lifehouse - First Time&apos;, u&apos;Lifehouse - Storm&apos;, u&apos;Eric Clapton - Tears In Heaven&apos;, u&apos;Lifehouse - Walking Away&apos;, u&apos;Secondhand Serenade - Fall For You&apos;, u&apos;Colbie Caillat - I Never Told You&apos;, u&apos;Lifehouse - It Is What It Is&apos;, u&apos;Train - Drops of Jupiter&apos;, u&apos;Avril Lavigne - Fall To Pieces&apos;, u&apos;Lifehouse - Somewhere In Between&apos;, u&apos;The Fray - Never Say Never&apos;, u&apos;Lifehouse - Into The Sun&apos;, u&apos;Daughtry - September&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&quot;Lifehouse - We&apos;ll Never Know&quot;, u&apos;Lifehouse - Undone&apos;, u&apos;Creed - One Last Breath&apos;, u&apos;3 Doors Down - Let Me Be Myself&apos;, u&quot;Avril Lavigne - Things I&apos;ll Never Say&quot;, u&apos;Snow Patrol - Chasing Cars (Live In Toronto)&apos;, u&apos;Alanis Morissette - Ironic (Acoustic Album Version)&apos;, u&quot;3 Doors Down - It&apos;s Not My Time&quot;, u&apos;Shinedown - Second Chance&apos;, u&apos;Lifehouse - By Your Side&apos;, u&apos;Simple Plan - Perfect&apos;, u&apos;Daniel Powter - Bad Day&apos;, u&quot;matchbox twenty - How Far We&apos;ve Come&quot;, u&quot;Linkin Park - What I&apos;ve Done&quot;, u&apos;Michael Bubl\\xe9 - Home&apos;, u&apos;Godsmack - What If?&apos;, u&apos;The Red Jumpsuit Apparatus - Face Down&apos;, u&apos;Linkin Park - In The End&apos;, u&quot;Anouk - It&apos;s So Hard&quot;, u&quot;Lifehouse - All That I&apos;m Asking For&quot;]\nUser: 193650\nRecommendations: [u&apos;Radiohead - Karma Police&apos;, u&apos;Radiohead - (Nice Dream)&apos;, u&apos;Radiohead - 15 Step&apos;, u&apos;Radiohead - Let Down&apos;, u&apos;Coldplay - Yellow&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&apos;Godsmack - What If?&apos;, u&apos;Muse - Supermassive Black Hole&apos;, u&apos;Jason Mraz - Lucky&apos;, u&apos;Train - All I Ever Wanted&apos;, u&quot;B.o.B - Nothin&apos; On You (feat. Bruno Mars)&quot;, u&apos;Radiohead - Thinking About You&apos;, u&apos;Travie McCoy - Billionaire&apos;, u&apos;Radiohead - How To Disappear Completely&apos;, u&apos;Freeway - The Nation&apos;, u&apos;Usher - There Goes My Baby&apos;, u&quot;Train - I&apos;m About To Come Alive&quot;, u&apos;Radiohead - Subterranean Homesick Alien&apos;, u&apos;Lifehouse - First Time&apos;, u&apos;Imogen Heap - Hide &amp; Seek&apos;, u&apos;MGMT - Time to Pretend&apos;, u&apos;Radiohead - Black Star&apos;, u&quot;Die Mooskirchner - Frisch und g&apos;sund&quot;, u&quot;Train - For Me, It&apos;s You&quot;, u&apos;Rise Against - Savior&apos;]\nAll Recommendations:\nUser: 84250\nRecommendations: [u&apos;Lifehouse - Falling In&apos;, u&apos;Lifehouse - From Where You Are&apos;, u&apos;Lifehouse - Storm&apos;, u&apos;Lifehouse - It Is What It Is&apos;, u&apos;Lifehouse - All In&apos;, u&apos;Lifehouse - Whatever It Takes&apos;, u&apos;Lifehouse - Had Enough&apos;, u&apos;Lifehouse - Walking Away&apos;, u&apos;Lifehouse - Into The Sun&apos;, u&quot;Lifehouse - We&apos;ll Never Know&quot;, u&apos;Godsmack - What If?&apos;, u&apos;Lifehouse - Somewhere In Between&apos;, u&apos;Lifehouse - Undone&apos;, u&quot;Lifehouse - All That I&apos;m Asking For&quot;, u&apos;Lifehouse - Take Me Away&apos;, u&apos;Lifehouse - By Your Side&apos;, u&apos;Lifehouse - Crash And Burn&apos;, u&apos;Lifehouse - First Time&apos;, u&apos;Freeway - The Nation&apos;, u&apos;Lifehouse - Smoke &amp; Mirrors&apos;, u&quot;Anouk - It&apos;s So Hard&quot;, u&apos;Moving Hearts - Finore&apos;, u&apos;Lifehouse - The End Has Only Begun&apos;, u&apos;Lifehouse - Who We Are&apos;, u&apos;Lifehouse - Simon&apos;, u&apos;Lifehouse - Only One&apos;, u&apos;Lifehouse - Anchor&apos;, u&apos;Lifehouse - In Your Skin&apos;, u&apos;Lifehouse - Nerve Damage&apos;, u&apos;Lifehouse - Today&apos;, u&apos;Lifehouse - Wrecking Ball&apos;, u&apos;Lifehouse - Here Tomorrow Gone Today&apos;, u&apos;Lifehouse - Disarray&apos;, u&apos;Lifehouse - Easier To Be&apos;, u&apos;Lifehouse - Make Me Over&apos;, u&apos;Lifehouse - Near Life Experience&apos;, u&apos;Lifehouse - The Joke&apos;, u&apos;Lifehouse - All In All&apos;, u&apos;Lifehouse - Come Back Down&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&apos;OneRepublic - Mercy&apos;, u&apos;Lifehouse - Learn You Inside Out&apos;, u&apos;OneRepublic - All We Are&apos;, u&quot;Train - I&apos;m About To Come Alive&quot;, u&apos;Lifehouse - Sky Is Falling&apos;, u&apos;Bo Diddley - Pills&apos;, u&apos;Train - All I Ever Wanted&apos;, u&apos;Lifehouse - Am I Ever Gonna Find Out&apos;, u&apos;OneRepublic - All Fall Down&apos;, u&apos;Train - Give Myself To You&apos;, u&quot;Train - If I Can&apos;t Change Your Mind&quot;, u&quot;Train - For Me, It&apos;s You&quot;, u&apos;Lifehouse - Days Go By&apos;, u&apos;OneRepublic - Someone To Save You&apos;, u&apos;Lifehouse - Mesmerized&apos;, u&apos;OneRepublic - Goodbye, Apathy&apos;, u&apos;Lifehouse - Quasimodo&apos;, u&apos;Home Grown - Kiss Me, Diss Me&apos;, u&apos;Train - All I Hear&apos;, u&apos;Train - Always Remember&apos;, u&apos;Lifehouse - Stanley Climbfall&apos;, u&apos;Train - Shelter Me&apos;, u&apos;Train - Skyscraper&apos;, u&apos;Train - Ordinary (Rock Version)&apos;, u&apos;Lifehouse - How Long&apos;, u&quot;Train - I&apos;m Not Waiting In Line&quot;, u&apos;The Fray - Never Say Never&apos;, u&apos;Lifehouse - The Beginning&apos;, u&apos;Lifehouse - My Precious&apos;, u&apos;Lifehouse - Unknown&apos;, u&apos;matchbox twenty - Hand Me Down&apos;, u&apos;Train - Getaway&apos;, u&apos;Train - Get Out&apos;, u&apos;Lifehouse - Just Another Name&apos;, u&apos;Lifehouse - Cling And Clatter&apos;, u&apos;OneRepublic - Prodigal&apos;, u&apos;Lifehouse - Sky Is Falling (Acoustic Version)&apos;, u&apos;3 Doors Down - Be Somebody (Acoustic 2)&apos;, u&apos;Lifehouse - Bridges&apos;, u&apos;Train - Explanation&apos;, u&apos;OneRepublic - Made For You&apos;, u&apos;Lifehouse - Empty Space&apos;, u&apos;OneRepublic - Dreaming Out Loud&apos;, u&apos;OneRepublic - Fear&apos;, u&apos;Ry Cooder - Corrido de Boxeo&apos;, u&apos;The Fray - Heartless - Swinghouse Session&apos;]\nUser: 92650\nRecommendations: [u&apos;Lifehouse - Whatever It Takes&apos;, u&apos;Lifehouse - From Where You Are&apos;, u&apos;Lifehouse - All In&apos;, u&apos;Lifehouse - Falling In&apos;, u&apos;Nickelback - Never Gonna Be Alone&apos;, u&apos;Lifehouse - First Time&apos;, u&apos;Lifehouse - Storm&apos;, u&apos;Eric Clapton - Tears In Heaven&apos;, u&apos;Lifehouse - Walking Away&apos;, u&apos;Dido - Thank You&apos;, u&apos;Secondhand Serenade - Fall For You&apos;, u&apos;Colbie Caillat - I Never Told You&apos;, u&apos;Lifehouse - It Is What It Is&apos;, u&apos;Train - Drops of Jupiter&apos;, u&apos;Avril Lavigne - Fall To Pieces&apos;, u&apos;Lifehouse - Take Me Away&apos;, u&apos;Lifehouse - Somewhere In Between&apos;, u&apos;The Fray - Never Say Never&apos;, u&apos;Lifehouse - Into The Sun&apos;, u&apos;Daughtry - September&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&quot;Lifehouse - We&apos;ll Never Know&quot;, u&apos;Lifehouse - Undone&apos;, u&apos;Creed - One Last Breath&apos;, u&apos;3 Doors Down - Let Me Be Myself&apos;, u&quot;Avril Lavigne - Things I&apos;ll Never Say&quot;, u&apos;Snow Patrol - Chasing Cars (Live In Toronto)&apos;, u&apos;Alanis Morissette - Ironic (Acoustic Album Version)&apos;, u&quot;3 Doors Down - It&apos;s Not My Time&quot;, u&apos;Shinedown - Second Chance&apos;, u&apos;Lifehouse - By Your Side&apos;, u&apos;Simple Plan - Perfect&apos;, u&apos;Daniel Powter - Bad Day&apos;, u&quot;matchbox twenty - How Far We&apos;ve Come&quot;, u&quot;Linkin Park - What I&apos;ve Done&quot;, u&apos;Michael Bubl\\xe9 - Home&apos;, u&apos;Godsmack - What If?&apos;, u&apos;The Red Jumpsuit Apparatus - Face Down&apos;, u&apos;Linkin Park - In The End&apos;, u&quot;Anouk - It&apos;s So Hard&quot;, u&quot;Lifehouse - All That I&apos;m Asking For&quot;]\nUser: 193650\nRecommendations: [u&apos;Radiohead - Karma Police&apos;, u&apos;Lifehouse - Falling In&apos;, u&apos;Lifehouse - All In&apos;, u&apos;Lifehouse - From Where You Are&apos;, u&apos;Lifehouse - Whatever It Takes&apos;, u&apos;Lifehouse - It Is What It Is&apos;, u&apos;Lifehouse - Storm&apos;, u&apos;Radiohead - (Nice Dream)&apos;, u&apos;Lifehouse - Walking Away&apos;, u&apos;Radiohead - 15 Step&apos;, u&apos;Radiohead - Let Down&apos;, u&apos;Lifehouse - Into The Sun&apos;, u&quot;Lifehouse - We&apos;ll Never Know&quot;, u&apos;Radiohead - Just&apos;, u&apos;Coldplay - Yellow&apos;, u&apos;Radiohead - Exit Music (For A Film)&apos;, u&apos;Radiohead - Talk Show Host&apos;, u&quot;Lifehouse - All That I&apos;m Asking For&quot;, u&apos;Lifehouse - Undone&apos;, u&quot;Diddy - I&apos;ll Be Missing You&quot;, u&apos;Lifehouse - Had Enough&apos;, u&apos;Lifehouse - Somewhere In Between&apos;, u&apos;Lifehouse - By Your Side&apos;, u&apos;Godsmack - What If?&apos;, u&apos;Lifehouse - Crash And Burn&apos;, u&apos;Lifehouse - Take Me Away&apos;, u&apos;Muse - Supermassive Black Hole&apos;, u&apos;Lifehouse - Smoke &amp; Mirrors&apos;, u&apos;Jason Mraz - Lucky&apos;, u&apos;Train - All I Ever Wanted&apos;, u&quot;B.o.B - Nothin&apos; On You (feat. Bruno Mars)&quot;, u&apos;Lifehouse - The End Has Only Begun&apos;, u&apos;Lifehouse - Who We Are&apos;, u&apos;Radiohead - Thinking About You&apos;, u&apos;Travie McCoy - Billionaire&apos;, u&apos;Radiohead - How To Disappear Completely&apos;, u&apos;Freeway - The Nation&apos;, u&apos;Usher - There Goes My Baby&apos;, u&quot;Train - I&apos;m About To Come Alive&quot;, u&apos;Radiohead - Subterranean Homesick Alien&apos;, u&apos;Lifehouse - First Time&apos;, u&apos;Imogen Heap - Hide &amp; Seek&apos;, u&apos;MGMT - Time to Pretend&apos;, u&apos;Radiohead - Black Star&apos;, u&quot;Die Mooskirchner - Frisch und g&apos;sund&quot;, u&quot;Train - For Me, It&apos;s You&quot;, u&apos;Rise Against - Savior&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.482002614645E12,"submitTime":1.482002613222E12,"finishTime":1.482002614682E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a22378d0-9dc3-4b3f-81ec-32e8516235ae"},{"version":"CommandV1","origId":1202,"guid":"bedad06b-6a46-470c-8a57-1387b6c190c8","subtype":"command","commandType":"auto","position":24.75,"command":"%md # Explore Spotify User Recommendations","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c6bc976d-b5a4-4cc9-9a3c-5ce514d2facf"},{"version":"CommandV1","origId":1220,"guid":"6c6af803-15bb-4718-9aa0-df3ed56af897","subtype":"command","commandType":"auto","position":25.25,"command":"spotify_users = [2000000, 3000000, 4000000]\nuser_history = get_history_by_user(spotify_users)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.482014203302E12,"submitTime":1.48201420184E12,"finishTime":1.482014264506E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"ebadcaaf-f826-405f-8780-b6dd8cc114e6"},{"version":"CommandV1","origId":1221,"guid":"a4fba268-bb70-44fc-a872-235c86cc4b51","subtype":"command","commandType":"auto","position":25.5,"command":"for user_id, history in user_history.iteritems():\n  print \"User:\", user_id\n  print \"History:\", remove_nas(history)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">User: 2000000\nHistory: [u&apos;Emancipator - Greenland&apos;, u&apos;Aphex Twin - I&apos;, u&apos;Prefuse 73 - Styles That Fade Away With A Collonade Reprise&apos;, u&apos;Ry Cooder - Dark End Of The Street&apos;, u&apos;Josephine Foster - Little Life&apos;, u&apos;Faunts - Explain&apos;, u&apos;LCD Soundsystem - Someone Great&apos;, u&apos;The Virgins - Rich Girls (The Twelves Remix)&apos;, u&apos;Vangelis - Keep Asking&apos;, u&apos;Little People - Idiom&apos;, u&apos;Band of Horses - Neighbor&apos;, u&apos;Trentem\\xf8ller - Vamp (Live Edit) (Bonus Track)&apos;, u&apos;Brightblack Morning Light - Hologram Buffalo&apos;, u&apos;Silkie - Concrete Jungle&apos;, u&quot;Faunts - I Think I&apos;ll Start a Fire&quot;, u&apos;The Album Leaf - Summer Fog&apos;, u&apos;Emil\\xedana Torrini - Lifesaver&apos;, u&apos;Prefuse 73 - Pentagram&apos;, u&apos;Little People - Behind Closed Doors (Edit)&apos;, u&apos;T\\xe9l\\xe9popmusik - Breathe (Remix By 2 Square)&apos;, u&apos;Beck - Broken Drum (Remixed By Boards Of Canada)&apos;, u&apos;Kyte - Solsbury Hill&apos;, u&apos;The Helio Sequence - Hallelujah&apos;, u&apos;Annie - When The Night&apos;, u&apos;Daniel Johnston - Story Of An Artist&apos;, u&apos;Prefuse 73 - Storm Returns (A Prefuse/Tommy Guerrero Interlude)&apos;, u&quot;Gramatik - Don&apos;t Get Weary&quot;, u&apos;Tim Hecker - Boreal Kiss Pt. 1&apos;, u&apos;The Octopus Project - Mmaj&apos;, u&quot;Daniel Johnston - I&apos;m Nervous&quot;, u&apos;Emancipator - Nevergreen&apos;, u&apos;William Basinski - Variation VIII&apos;, u&apos;Faunts - It Hurts Me all the Time&apos;, u&apos;Lawrence English - The Prelude To&apos;, u&apos;Sun Kil Moon - Like The River&apos;, u&apos;CFCF - Invitation To Love&apos;]\nUser: 3000000\nHistory: [u&apos;Hum - The Very Old Man&apos;, u&quot;The Mono Men - You&apos;re Gonna Miss Me&quot;, u&apos;Weezer - Across The Sea&apos;, u&apos;Stone Temple Pilots - Dead &amp; Bloated&apos;, u&apos;Alice in Chains - Black Gives Way To Blue&apos;, u&apos;The Mono Men - Return Of The Rat&apos;, u&apos;Blind Melon - John Sinclair&apos;, u&apos;Soundgarden - Nazi Driver&apos;, u&apos;Mad Season - X-Ray Mind&apos;, u&apos;Hum - The Pod&apos;, u&apos;Blind Melon - Hell&apos;, u&apos;Hum - Suicide Machine&apos;, u&apos;Alice in Chains - Your Decision&apos;, u&apos;The Corrs - Hopelessly Addicted ( LP Version )&apos;, u&apos;The Zutons - Railroad&apos;, u&apos;The Zutons - Remember Me&apos;, u&quot;Pearl Jam - Even Flow (2008 Brendan O&apos;Brien Mix)&quot;, u&apos;The Zutons - Moons And Horror Shows&apos;, u&apos;Weezer - Tired Of Sex&apos;, u&apos;Jimi Hendrix - Voodoo Chile Blues&apos;, u&apos;Blind Melon - Letters From A Porcupine&apos;, u&apos;The Zutons - Long Time Coming&apos;, u&apos;Blind Melon - Glitch&apos;, u&apos;Blind Melon - The Pusher&apos;]\nUser: 4000000\nHistory: [u&quot;Kenny Garrett - Before It&apos;s Time To Say Goodbye&quot;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.482014267035E12,"submitTime":1.482014265582E12,"finishTime":1.482014267057E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bafb831f-b0e0-4ff3-9e15-5b8fdaca11bc"},{"version":"CommandV1","origId":1217,"guid":"e87545ab-4048-4259-8b47-02357d9fb588","subtype":"command","commandType":"auto","position":25.75,"command":"# What are the users recommendations?\nrecommendations_new = get_recommendations_by_user(spotify_users, num_recs=100, only_new_songs=True, path_to_model='/mnt/S3/models/spotify_model')\nrecommendations_all = get_recommendations_by_user(spotify_users, num_recs=100, only_new_songs=False, path_to_model='/mnt/S3/models/spotify_model')","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"<span class=\"ansired\">TypeError</span>: get_recommendations_by_user() got an unexpected keyword argument &apos;path_to_model&apos;","error":"<div class=\"ansiout\"><span class=\"ansired\">---------------------------------------------------------------------------</span>\n<span class=\"ansired\">TypeError</span>                                 Traceback (most recent call last)\n<span class=\"ansigreen\">&lt;ipython-input-17-8db08474dd74&gt;</span> in <span class=\"ansicyan\">&lt;module&gt;</span><span class=\"ansiblue\">()</span>\n<span class=\"ansigreen\">      1</span> <span class=\"ansired\"># What are the users recommendations?</span><span class=\"ansiyellow\"></span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">----&gt; 2</span><span class=\"ansiyellow\"> </span>recommendations_new <span class=\"ansiyellow\">=</span> get_recommendations_by_user<span class=\"ansiyellow\">(</span>spotify_users<span class=\"ansiyellow\">,</span> num_recs<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">100</span><span class=\"ansiyellow\">,</span> only_new_songs<span class=\"ansiyellow\">=</span>True<span class=\"ansiyellow\">,</span> path_to_model<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;/mnt/S3/models/spotify_model&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n<span class=\"ansigreen\">      3</span> recommendations_all <span class=\"ansiyellow\">=</span> get_recommendations_by_user<span class=\"ansiyellow\">(</span>spotify_users<span class=\"ansiyellow\">,</span> num_recs<span class=\"ansiyellow\">=</span><span class=\"ansicyan\">100</span><span class=\"ansiyellow\">,</span> only_new_songs<span class=\"ansiyellow\">=</span>False<span class=\"ansiyellow\">,</span> path_to_model<span class=\"ansiyellow\">=</span><span class=\"ansiblue\">&apos;/mnt/S3/models/spotify_model&apos;</span><span class=\"ansiyellow\">)</span><span class=\"ansiyellow\"></span>\n\n<span class=\"ansired\">TypeError</span>: get_recommendations_by_user() got an unexpected keyword argument &apos;path_to_model&apos;\n</div>","workflows":[],"startTime":1.482014310294E12,"submitTime":1.482014308829E12,"finishTime":1.482014484631E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9896c14f-701f-4363-9165-61f76d89e2cd"},{"version":"CommandV1","origId":1218,"guid":"e8bb4105-dd6a-4f53-8420-1ce851b62eef","subtype":"command","commandType":"auto","position":26.75,"command":"# Get user recommendations\nprint \"New Recommendations:\"\nfor user_id, recommendations in recommendations_new.iteritems():\n  print \"User:\", user_id\n  print \"Recommendations:\", remove_nas(recommendations)\n  \nprint \"All Recommendations:\"\nfor user_id, recommendations in recommendations_all.iteritems():\n  print \"User:\", user_id\n  print \"Recommendations:\", remove_nas(recommendations)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">New Recommendations:\nUser: 2000000\nRecommendations: [u&apos;Gold Panda - You&apos;, u&apos;ATB - Believe In Me (A&amp;T Remix)&apos;, u&apos;Local Natives - Wide Eyes&apos;, u&apos;Crystal Castles - Untrust Us&apos;, u&apos;Alceu Valen\\xe7a - No Balan\\xe7o Da Canoa&apos;, u&apos;Aphex Twin - Xtal&apos;, u&apos;Stardeath and White Dwarfs - Time/Breathe [Reprise]&apos;, u&apos;Four Tet - Angel Echoes&apos;, u&apos;Caribou - Sun&apos;, u&apos;Zero 7 - In The Waiting Line&apos;, u&apos;Local Natives - Airplanes&apos;, u&apos;Four Tet - Everything Is Alright&apos;, u&apos;Discovery - Osaka Loop Line&apos;, u&apos;Crystal Castles - Celestica&apos;, u&apos;Local Natives - Who Knows Who Cares&apos;, u&apos;Cut Copy - Feel The Love&apos;, u&apos;Cut Copy - Strangers In The Wind&apos;, u&apos;Cut Copy - Saturdays&apos;, u&apos;Junior Boys - In The Morning&apos;, u&apos;Bonobo - Kota&apos;, u&apos;Little People - Moon&apos;, u&apos;Discovery - Swing Tree&apos;, u&quot;Little People - Start Shootin&apos;&quot;, u&apos;Nightmares on Wax - You Wish&apos;, u&apos;PANTyRAiD - Get The Money&apos;, u&apos;Ratatat - Wildcat&apos;, u&apos;Beats Antique - Beauty Beats&apos;, u&apos;Bonobo - Kong&apos;, u&quot;Bootsy Collins - Stretchin&apos; Out (In A Rubber Band)&quot;, u&apos;Bonobo - Noctuary&apos;, u&apos;Ratatat - Mirando&apos;, u&apos;Passion Pit - Live To Tell The Tale&apos;, u&apos;Gorillaz - Empire Ants (feat. Little Dragon)&apos;, u&apos;Caribou - Jamelia&apos;, u&apos;Passion Pit - Swimming In The Flood&apos;, u&apos;Cut Copy - Out There On The Ice&apos;, u&apos;Ratatat - Drugs&apos;, u&apos;Crystal Castles - Courtship Dating&apos;, u&apos;Caribou - Leave House&apos;, u&apos;Lily Allen - Littlest Things (Live At The Astoria)&apos;, u&apos;Notes From Underground - Be Like You&apos;, u&apos;Bonobo - Pick Up&apos;, u&apos;R\\xf6yksopp - R\\xf6yksopp Forever&apos;, u&apos;Cut Copy - Time Stands Still&apos;, u&apos;Ratatat - Nostrand&apos;, u&apos;Crystal Castles - Suffocation&apos;, u&apos;Caribou - Lalibela&apos;, u&apos;Apparat - Arcadia&apos;, u&apos;LCD Soundsystem - I Can Change&apos;, u&apos;Caribou - Hannibal&apos;, u&apos;Caribou - Found Out&apos;, u&apos;Local Natives - Shape Shifter&apos;, u&apos;The XX - Fantasy&apos;, u&apos;Crystal Castles - Baptism&apos;, u&apos;Local Natives - Sun Hands&apos;, u&apos;LCD Soundsystem - Home&apos;, u&apos;Blockhead - Carnivores Unite&apos;, u&apos;Crystal Castles - Empathy&apos;, u&apos;Four Tet - Plastic People&apos;]\nUser: 3000000\nRecommendations: [u&apos;Stone Temple Pilots - Wicked Garden&apos;, u&apos;Stone Temple Pilots - Lady Picture Show&apos;, u&apos;Stone Temple Pilots - Plush (Acoustic)&apos;, u&apos;Temple of the Dog - Hunger Strike&apos;, u&apos;Stone Temple Pilots - Interstate Love Song&apos;, u&quot;Audioslave - Doesn&apos;t Remind Me&quot;, u&apos;Audioslave - I Am The Highway&apos;, u&apos;I Wayne - Bleacher&apos;, u&apos;Alice in Chains - Check My Brain&apos;, u&apos;Pearl Jam - Dissident&apos;, u&apos;The Borodin String Quartet - Mahler: Quartet for Piano and Strings in A minor: Allegro&apos;, u&apos;Audioslave - Shadow On The Sun&apos;, u&apos;M.A. Numminen - Tulenliekki&apos;, u&apos;Mad Season - River Of Deceit&apos;, u&apos;Stone Temple Pilots - Sour Girl&apos;, u&apos;Hem - The Golden Day Is Dying&apos;, u&apos;Nirvana - Heart-Shaped Box&apos;, u&apos;Stone Temple Pilots - Unglued&apos;, u&apos;Alice in Chains - Shame In You&apos;, u&apos;Mondo Marcio - Il Solo Rimasto&apos;, u&apos;Stone Temple Pilots - Where The River Goes&apos;, u&apos;Stone Temple Pilots - Silvergun Superman&apos;, u&apos;Stone Temple Pilots - Days Of The Week&apos;, u&apos;Pearl Jam - The End&apos;, u&apos;Pearl Jam - Daughter&apos;, u&apos;Chris Cornell - Billie Jean&apos;, u&apos;Faith No More - Midlife Crisis&apos;, u&apos;Tania Libertad - Fragilidad&apos;, u&apos;Despina Vandi - Gia&apos;, u&quot;Foo Fighters - I&apos;ll Stick Around&quot;, u&apos;Stone Temple Pilots - Meatplow&apos;, u&apos;Alice in Chains - Grind&apos;, u&apos;Nirvana - Drain You (Live (1991/Del Mar Fairgrounds))&apos;, u&apos;Arma Blanca - Beatbox (Nus Track)&apos;, u&apos;Audioslave - Out Of Exile&apos;, u&apos;Alice in Chains - Lesson Learned&apos;, u&apos;PFR - Do You Want To Know Love (Pray For Rain Album Version)&apos;, u&apos;Live - All Over You&apos;, u&apos;Soundgarden - My Wave&apos;, u&apos;David Crowder Band - Only You (Illuminate Album Version)&apos;, u&apos;Audioslave - Be Yourself&apos;, u&apos;Stone Temple Pilots - Lounge Fly&apos;, u&apos;Temple of the Dog - Say Hello 2 Heaven&apos;, u&apos;Alice in Chains - Down In A Hole (Live)&apos;]\nUser: 4000000\nRecommendations: [u&apos;Keller Williams - 221&quot;&apos;, u&apos;The Black Keys - Busted&apos;, u&apos;Jim Jones - Pop Champagne (Explicit Album Version)&apos;, u&apos;Jack Johnson - Taylor&apos;, u&apos;Cat Stevens - If You Want To Sing Out, Sing Out&apos;, u&apos;Mano Negra - Mala Vida&apos;, u&apos;The Black Keys - Heavy Soul&apos;, u&apos;The Black Eyed Peas - Hey Mama&apos;, u&quot;The Black Keys - I&apos;ll Be Your Man&quot;, u&apos;The Black Keys - Everywhere I Go&apos;, u&apos;Eisbrecher - Adrenalin&apos;, u&apos;The Black Keys - Run Me Down&apos;, u&apos;Hell Razah - Project Jazz&apos;, u&apos;The Black Keys - 240 Years Before Your Time&apos;, u&apos;Andrea Bocelli - Con Te Partiro&apos;, u&apos;The Black Keys - Elevator&apos;, u&apos;The Temper Trap - Fools&apos;, u&apos;Twista - Give It Up&apos;, u&apos;Damien Rice - Amie&apos;, u&apos;Red Hot Chili Peppers - Strip My Mind&apos;, u&apos;The Temper Trap - Rest&apos;, u&apos;The Black Keys - Have Mercy On Me&apos;, u&apos;Jack Johnson - Holes To Heaven&apos;, u&apos;The Black Keys - Meet Me In the City&apos;, u&apos;Duncan Dhu - Reina De Africa&apos;, u&apos;Ratatat - Lex&apos;, u&apos;The Temper Trap - Drum Song&apos;, u&quot;Andrea Bocelli - Cuando Me Enamoro (Quando M&apos;Innamoro)&quot;, u&quot;Red Hot Chili Peppers - Road Trippin&apos;&quot;, u&apos;Ratatat - Kennedy&apos;, u&apos;Simon Webbe - Sunshine (Love Like That)&apos;, u&apos;White Town - Your Woman&apos;, u&apos;Hot Chip - Over And Over (Maurice Fulton Dub)&apos;, u&apos;Maldita Nerea - La Raya&apos;, u&quot;Drowning Pool - Reason I&apos;m Alive&quot;, u&apos;Skillet - Rebirthing&apos;, u&apos;Ratatat - Mirando&apos;, u&quot;Marty Stuart - Kiss Me, I&apos;m Gone&quot;, u&apos;Cat Stevens - Portobello Road (Stereo Version)&apos;, u&apos;Ratatat - Nostrand&apos;, u&apos;Ratatat - Tropicana&apos;, u&apos;Ratatat - Montanita&apos;, u&apos;Ratatat - Swisha&apos;, u&quot;Sam &amp; Dave - Hold On I&apos;m Comin&apos;&quot;, u&apos;Buena Vista Social Club - Murmullo&apos;, u&apos;Seine - So Far So Long&apos;, u&quot;Stacey Kent - Makin&apos; Whoopee&quot;, u&apos;Moimir Papalescu &amp; The Nihilists - Life Could Be So Easy&apos;, u&apos;Justin Bieber - Never Let You Go&apos;, u&apos;Jeff Golub - Slinky&apos;, u&apos;Ratatat - Tacobel Canon&apos;, u&apos;Buena Vista Social Club - Amor de Loca Juventud&apos;, u&apos;MxPx - Invitation To Understanding&apos;, u&apos;The Heavy - Short Change Hero&apos;, u&apos;Lamb - Angelica&apos;, u&apos;Damien Rice - Cannonball&apos;, u&apos;Buena Vista Social Club - La Bayamesa&apos;, u&apos;Ratatat - Wildcat&apos;, u&apos;The Black Keys - Girl Is On My Mind&apos;, u&apos;The Black Keys - Do The Rump&apos;]\nAll Recommendations:\nUser: 2000000\nRecommendations: [u&apos;LCD Soundsystem - Someone Great&apos;, u&apos;Gold Panda - You&apos;, u&apos;ATB - Believe In Me (A&amp;T Remix)&apos;, u&apos;Local Natives - Wide Eyes&apos;, u&apos;Crystal Castles - Untrust Us&apos;, u&apos;Alceu Valen\\xe7a - No Balan\\xe7o Da Canoa&apos;, u&apos;Aphex Twin - Xtal&apos;, u&apos;Stardeath and White Dwarfs - Time/Breathe [Reprise]&apos;, u&apos;Four Tet - Angel Echoes&apos;, u&apos;Caribou - Sun&apos;, u&apos;Zero 7 - In The Waiting Line&apos;, u&apos;Local Natives - Airplanes&apos;, u&apos;Four Tet - Everything Is Alright&apos;, u&apos;Discovery - Osaka Loop Line&apos;, u&apos;Crystal Castles - Celestica&apos;, u&apos;Local Natives - Who Knows Who Cares&apos;, u&apos;Cut Copy - Feel The Love&apos;, u&apos;Cut Copy - Strangers In The Wind&apos;, u&apos;Cut Copy - Saturdays&apos;, u&apos;Junior Boys - In The Morning&apos;, u&apos;Bonobo - Kota&apos;, u&apos;Little People - Moon&apos;, u&apos;Discovery - Swing Tree&apos;, u&quot;Little People - Start Shootin&apos;&quot;, u&apos;Nightmares on Wax - You Wish&apos;, u&apos;PANTyRAiD - Get The Money&apos;, u&apos;Ratatat - Wildcat&apos;, u&apos;Beats Antique - Beauty Beats&apos;, u&apos;Bonobo - Kong&apos;, u&quot;Bootsy Collins - Stretchin&apos; Out (In A Rubber Band)&quot;, u&apos;Bonobo - Noctuary&apos;, u&apos;Ratatat - Mirando&apos;, u&apos;Passion Pit - Live To Tell The Tale&apos;, u&apos;Gorillaz - Empire Ants (feat. Little Dragon)&apos;, u&apos;Caribou - Jamelia&apos;, u&apos;Passion Pit - Swimming In The Flood&apos;, u&apos;Cut Copy - Out There On The Ice&apos;, u&apos;Ratatat - Drugs&apos;, u&apos;Crystal Castles - Courtship Dating&apos;, u&apos;Caribou - Leave House&apos;, u&apos;Lily Allen - Littlest Things (Live At The Astoria)&apos;, u&apos;Notes From Underground - Be Like You&apos;, u&apos;Bonobo - Pick Up&apos;, u&apos;R\\xf6yksopp - R\\xf6yksopp Forever&apos;, u&apos;Cut Copy - Time Stands Still&apos;, u&apos;Ratatat - Nostrand&apos;, u&apos;Crystal Castles - Suffocation&apos;, u&apos;Caribou - Lalibela&apos;, u&apos;Apparat - Arcadia&apos;, u&apos;LCD Soundsystem - I Can Change&apos;, u&apos;Caribou - Hannibal&apos;, u&apos;Caribou - Found Out&apos;, u&apos;Local Natives - Shape Shifter&apos;, u&apos;The XX - Fantasy&apos;, u&apos;Crystal Castles - Baptism&apos;, u&apos;Local Natives - Sun Hands&apos;, u&apos;LCD Soundsystem - Home&apos;, u&apos;Blockhead - Carnivores Unite&apos;, u&apos;Crystal Castles - Empathy&apos;, u&apos;Four Tet - Plastic People&apos;]\nUser: 3000000\nRecommendations: [u&apos;Stone Temple Pilots - Wicked Garden&apos;, u&apos;Stone Temple Pilots - Dead &amp; Bloated&apos;, u&quot;Pearl Jam - Even Flow (2008 Brendan O&apos;Brien Mix)&quot;, u&apos;Stone Temple Pilots - Lady Picture Show&apos;, u&apos;Stone Temple Pilots - Plush (Acoustic)&apos;, u&apos;Temple of the Dog - Hunger Strike&apos;, u&apos;Stone Temple Pilots - Interstate Love Song&apos;, u&quot;Audioslave - Doesn&apos;t Remind Me&quot;, u&apos;Audioslave - I Am The Highway&apos;, u&apos;I Wayne - Bleacher&apos;, u&apos;Alice in Chains - Your Decision&apos;, u&apos;Alice in Chains - Check My Brain&apos;, u&apos;Pearl Jam - Dissident&apos;, u&apos;The Borodin String Quartet - Mahler: Quartet for Piano and Strings in A minor: Allegro&apos;, u&apos;Audioslave - Shadow On The Sun&apos;, u&apos;M.A. Numminen - Tulenliekki&apos;, u&apos;Mad Season - River Of Deceit&apos;, u&apos;Stone Temple Pilots - Sour Girl&apos;, u&apos;Hem - The Golden Day Is Dying&apos;, u&apos;Nirvana - Heart-Shaped Box&apos;, u&apos;Stone Temple Pilots - Unglued&apos;, u&apos;Alice in Chains - Shame In You&apos;, u&apos;Mondo Marcio - Il Solo Rimasto&apos;, u&apos;Stone Temple Pilots - Where The River Goes&apos;, u&apos;Stone Temple Pilots - Silvergun Superman&apos;, u&apos;Stone Temple Pilots - Days Of The Week&apos;, u&apos;Pearl Jam - The End&apos;, u&apos;Pearl Jam - Daughter&apos;, u&apos;Chris Cornell - Billie Jean&apos;, u&apos;Faith No More - Midlife Crisis&apos;, u&apos;Tania Libertad - Fragilidad&apos;, u&apos;Despina Vandi - Gia&apos;, u&quot;Foo Fighters - I&apos;ll Stick Around&quot;, u&apos;Stone Temple Pilots - Meatplow&apos;, u&apos;Alice in Chains - Grind&apos;, u&apos;Nirvana - Drain You (Live (1991/Del Mar Fairgrounds))&apos;, u&apos;Arma Blanca - Beatbox (Nus Track)&apos;, u&apos;Audioslave - Out Of Exile&apos;, u&apos;Alice in Chains - Lesson Learned&apos;, u&apos;PFR - Do You Want To Know Love (Pray For Rain Album Version)&apos;, u&apos;Live - All Over You&apos;, u&apos;Soundgarden - My Wave&apos;, u&apos;David Crowder Band - Only You (Illuminate Album Version)&apos;, u&apos;Audioslave - Be Yourself&apos;, u&apos;Stone Temple Pilots - Lounge Fly&apos;, u&apos;Temple of the Dog - Say Hello 2 Heaven&apos;, u&apos;Alice in Chains - Down In A Hole (Live)&apos;]\nUser: 4000000\nRecommendations: [u&apos;Keller Williams - 221&quot;&apos;, u&apos;The Black Keys - Busted&apos;, u&apos;Jim Jones - Pop Champagne (Explicit Album Version)&apos;, u&apos;Jack Johnson - Taylor&apos;, u&apos;Cat Stevens - If You Want To Sing Out, Sing Out&apos;, u&apos;Mano Negra - Mala Vida&apos;, u&apos;The Black Keys - Heavy Soul&apos;, u&apos;The Black Eyed Peas - Hey Mama&apos;, u&quot;The Black Keys - I&apos;ll Be Your Man&quot;, u&apos;The Black Keys - Everywhere I Go&apos;, u&apos;Eisbrecher - Adrenalin&apos;, u&apos;The Black Keys - Run Me Down&apos;, u&apos;Hell Razah - Project Jazz&apos;, u&apos;The Black Keys - 240 Years Before Your Time&apos;, u&apos;Andrea Bocelli - Con Te Partiro&apos;, u&apos;The Black Keys - Elevator&apos;, u&apos;The Temper Trap - Fools&apos;, u&apos;Twista - Give It Up&apos;, u&apos;Damien Rice - Amie&apos;, u&apos;Red Hot Chili Peppers - Strip My Mind&apos;, u&apos;The Temper Trap - Rest&apos;, u&apos;The Black Keys - Have Mercy On Me&apos;, u&apos;Jack Johnson - Holes To Heaven&apos;, u&apos;The Black Keys - Meet Me In the City&apos;, u&apos;Duncan Dhu - Reina De Africa&apos;, u&apos;Ratatat - Lex&apos;, u&apos;The Temper Trap - Drum Song&apos;, u&quot;Andrea Bocelli - Cuando Me Enamoro (Quando M&apos;Innamoro)&quot;, u&quot;Red Hot Chili Peppers - Road Trippin&apos;&quot;, u&apos;Ratatat - Kennedy&apos;, u&apos;Simon Webbe - Sunshine (Love Like That)&apos;, u&apos;White Town - Your Woman&apos;, u&apos;Hot Chip - Over And Over (Maurice Fulton Dub)&apos;, u&apos;Maldita Nerea - La Raya&apos;, u&quot;Drowning Pool - Reason I&apos;m Alive&quot;, u&apos;Skillet - Rebirthing&apos;, u&apos;Ratatat - Mirando&apos;, u&quot;Marty Stuart - Kiss Me, I&apos;m Gone&quot;, u&apos;Cat Stevens - Portobello Road (Stereo Version)&apos;, u&apos;Ratatat - Nostrand&apos;, u&apos;Ratatat - Tropicana&apos;, u&apos;Ratatat - Montanita&apos;, u&apos;Ratatat - Swisha&apos;, u&quot;Sam &amp; Dave - Hold On I&apos;m Comin&apos;&quot;, u&apos;Buena Vista Social Club - Murmullo&apos;, u&apos;Seine - So Far So Long&apos;, u&quot;Stacey Kent - Makin&apos; Whoopee&quot;, u&apos;Moimir Papalescu &amp; The Nihilists - Life Could Be So Easy&apos;, u&apos;Justin Bieber - Never Let You Go&apos;, u&apos;Jeff Golub - Slinky&apos;, u&apos;Ratatat - Tacobel Canon&apos;, u&apos;Buena Vista Social Club - Amor de Loca Juventud&apos;, u&apos;MxPx - Invitation To Understanding&apos;, u&apos;The Heavy - Short Change Hero&apos;, u&apos;Lamb - Angelica&apos;, u&apos;Damien Rice - Cannonball&apos;, u&apos;Buena Vista Social Club - La Bayamesa&apos;, u&apos;Ratatat - Wildcat&apos;, u&apos;The Black Keys - Girl Is On My Mind&apos;, u&apos;The Black Keys - Do The Rump&apos;]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":null,"error":null,"workflows":[],"startTime":1.482014484636E12,"submitTime":1.482014313885E12,"finishTime":1.482014484674E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1ec1e424-b226-4f44-a1b4-de7ac9fc92b3"}],"dashboards":[],"guid":"0ab75f2f-ba31-4da2-85cf-6d875d4c909d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
<script>var tableOfContentsCell = {"version":"CommandV1","origId":0,"guid":"5930c04d-6fff-4bd9-92be-56573cf37878","subtype":"command","commandType":"auto","position":0.0,"command":"%md [&lsaquo; Back to Table of Contents](index.html)","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{}},"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":0.0,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{}};</script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>